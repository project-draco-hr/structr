{
  final String type=GraphObject.type.dbName();
  if (relationship.hasProperty(type)) {
    Object obj=relationship.getProperty(type);
    if (obj != null) {
      return getModuleService().getRelationshipEntityClass(obj.toString());
    }
  }
  final String combinedTypeName="combinedType";
  if (relationship.hasProperty(combinedTypeName)) {
    Object obj=relationship.getProperty(combinedTypeName);
    if (obj != null) {
      final String combinedType=obj.toString();
      final Class entityType=getClassForCombinedType(combinedType);
      if (entityType != null) {
        return entityType;
      }
    }
  }
  final String sourceType=relationship.getStartNode().hasProperty(type) ? relationship.getStartNode().getProperty(type).toString() : null;
  final String targetType=relationship.getEndNode().hasProperty(type) ? relationship.getEndNode().getProperty(type).toString() : null;
  final String relType=relationship.getType().name();
  final Class entityType=getClassForCombinedType(sourceType,relType,targetType);
  if (entityType != null) {
    return entityType;
  }
  return getGenericRelationshipType();
}
