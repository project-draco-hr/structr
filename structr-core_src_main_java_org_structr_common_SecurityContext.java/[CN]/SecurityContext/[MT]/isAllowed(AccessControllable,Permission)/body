{
  if (node == null) {
    return false;
  }
  if (isSuperUser()) {
    return true;
  }
  Principal user=getUser(false);
  if (user == null) {
    return false;
  }
  Principal owner=node.getOwnerNode();
  if (user.equals(node) || user.equals(owner) || user.getParents().contains(owner)) {
    return true;
  }
  return node.isGranted(permission,user);
}
