{
  Authenticator authenticator=null;
  if (servletConfig != null) {
    String authenticatorClassName=servletConfig.getInitParameter(AuthenticationService.SERVLET_PARAMETER_AUTHENTICATOR);
    boolean userAutoCreate=Boolean.parseBoolean(servletConfig.getInitParameter(AuthenticationService.SERVLET_PARAMETER_USER_AUTO_CREATE));
    Class userClass=null;
    String userClassString=null;
    try {
      userClassString=servletConfig.getInitParameter(AuthenticationService.SERVLET_PARAMETER_USER_CLASS);
      if (StringUtils.isNotBlank(userClassString)) {
        userClass=Class.forName(userClassString);
      }
    }
 catch (    ClassNotFoundException ex) {
      logger.log(Level.WARNING,"Could not create user class for name: " + userClassString,ex);
    }
    if (authenticatorClassName != null) {
      try {
        Class authenticatorClass=Class.forName(authenticatorClassName);
        authenticator=(Authenticator)authenticatorClass.newInstance();
        servletConfig.getServletContext().setAttribute(AuthenticationService.SERVLET_PARAMETER_AUTHENTICATOR,authenticator);
        authenticator.setUserAutoCreate(userAutoCreate,userClass);
      }
 catch (      Throwable t) {
        logger.log(Level.SEVERE,"Error instantiating authenticator for servlet with context path {0}: {1}",new Object[]{servletConfig.getServletName(),t});
      }
    }
 else {
      logger.log(Level.SEVERE,"No authenticator for servlet with context path {0}",servletConfig.getServletName());
    }
    return authenticator;
  }
  return null;
}
