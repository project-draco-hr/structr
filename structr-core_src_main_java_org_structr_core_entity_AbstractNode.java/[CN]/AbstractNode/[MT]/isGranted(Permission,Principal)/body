{
  if (accessingUser != null && accessingUser instanceof SuperUser) {
    return true;
  }
  if (permission == null) {
    return false;
  }
  final Principal owner=getOwnerNode();
  final boolean hasOwner=(owner != null);
  if (hasOwner && accessingUser == null) {
    return false;
  }
  if (!hasOwner && accessingUser == null) {
    return true;
  }
  if (accessingUser != null) {
    if (hasOwner && accessingUser.equals(owner)) {
      return true;
    }
    Security r=getSecurityRelationship(accessingUser);
    if ((r != null) && r.isAllowed(permission)) {
      return true;
    }
    for (    Principal parent : accessingUser.getParents()) {
      if (isGranted(permission,parent)) {
        return true;
      }
    }
  }
  return false;
}
