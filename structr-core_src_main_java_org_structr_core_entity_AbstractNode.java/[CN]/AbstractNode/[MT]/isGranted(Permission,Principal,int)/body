{
  if (isCreation && (accessingUser == null || accessingUser.equals(getOwnerNode()))) {
    return true;
  }
  if (accessingUser != null && accessingUser.isAdmin()) {
    return true;
  }
  if (this.equals(accessingUser) && level == 0) {
    return true;
  }
  if (level > 0 && this instanceof Group && permission.equals(Permission.read)) {
    return true;
  }
  final Principal owner=getOwnerNode();
  final boolean hasOwner=(owner != null);
  if (!hasOwner && Services.getPermissionsForOwnerlessNodes().contains(permission)) {
    if (accessingUser != null && isVisibleToAuthenticatedUsers()) {
      return true;
    }
    if (accessingUser == null && isVisibleToPublicUsers()) {
      return true;
    }
  }
  if (hasOwner && accessingUser == null) {
    return false;
  }
  if (accessingUser != null) {
    if (hasOwner && accessingUser.equals(owner)) {
      return true;
    }
    final Security security=getSecurityRelationship(accessingUser);
    if (security != null && security.isAllowed(permission)) {
      return true;
    }
    for (    Principal parent : accessingUser.getParents()) {
      if (isGranted(permission,parent,level + 1)) {
        return true;
      }
    }
  }
  return false;
}
