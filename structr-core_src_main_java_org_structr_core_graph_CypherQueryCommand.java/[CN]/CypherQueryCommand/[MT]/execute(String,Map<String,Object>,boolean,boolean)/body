{
  ExecutionEngine engine=(ExecutionEngine)arguments.get("cypherExecutionEngine");
  RelationshipFactory relFactory=new RelationshipFactory(securityContext);
  NodeFactory nodeFactory=new NodeFactory(securityContext);
  List<GraphObject> resultList=new LinkedList<>();
  ExecutionResult result=null;
  if (parameters != null) {
    result=engine.execute(query,parameters);
  }
 else {
    result=engine.execute(query);
  }
  for (  Map<String,Object> row : result) {
    GraphObjectMap dummyObject=null;
    for (    Entry<String,Object> entry : row.entrySet()) {
      String key=entry.getKey();
      Object value=entry.getValue();
      if (value instanceof Node) {
        NodeInterface node=nodeFactory.instantiate((Node)value,includeHiddenAndDeleted,publicOnly);
        if (node != null) {
          resultList.add(node);
        }
      }
 else       if (value instanceof Relationship) {
        RelationshipInterface rel=relFactory.instantiate((Relationship)value);
        if (rel != null) {
          resultList.add(rel);
        }
      }
 else {
        if (dummyObject == null) {
          dummyObject=new GraphObjectMap();
          resultList.add(dummyObject);
        }
        dummyObject.setProperty(new GenericProperty(key),value);
      }
    }
  }
  return resultList;
}
