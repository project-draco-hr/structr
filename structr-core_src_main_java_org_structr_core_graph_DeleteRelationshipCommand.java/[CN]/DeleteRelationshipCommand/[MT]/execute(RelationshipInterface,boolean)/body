{
  GraphDatabaseService graphDb=(GraphDatabaseService)arguments.get("graphDb");
  if (graphDb != null && rel != null) {
    if (rel.getProperty(AbstractRelationship.uuid) == null) {
      logger.log(Level.WARNING,"Will not delete relationship which has no UUID: {0} --[:{1}]-->{2}",new Object[]{rel.getSourceNode(),rel.getType(),rel.getTargetNode()});
      return null;
    }
    final Relationship relToDelete=rel.getRelationship();
    final RelationshipInterface finalRel=rel;
    logger.log(Level.INFO,"DELETING relationship {0}-[{1}]->{2}",new Object[]{rel.getSourceNode().getType(),rel.getRelType(),rel.getTargetNode().getType()});
    Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
      @Override public Object execute() throws FrameworkException {
        TransactionCommand.relationshipDeleted(finalRel,passiveDeletion);
        try {
          finalRel.removeFromIndex();
          relToDelete.delete();
        }
 catch (        IllegalStateException ise) {
          logger.log(Level.WARNING,ise.getMessage());
        }
        return null;
      }
    }
);
  }
  return null;
}
