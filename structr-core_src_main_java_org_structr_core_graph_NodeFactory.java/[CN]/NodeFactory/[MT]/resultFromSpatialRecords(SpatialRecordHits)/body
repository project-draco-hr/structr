{
  final int pageSize=factoryProfile.getPageSize();
  final SecurityContext securityContext=factoryProfile.getSecurityContext();
  final boolean includeDeletedAndHidden=factoryProfile.includeDeletedAndHidden();
  final boolean publicOnly=factoryProfile.publicOnly();
  List<T> nodes=new LinkedList<T>();
  int size=spatialRecordHits.size();
  int position=0;
  int count=0;
  int offset=0;
  for (  Node node : spatialRecordHits) {
    Node realNode=node;
    if (realNode != null) {
      T n=instantiate(realNode);
      nodes.add(n);
      if (n != null) {
        List<AbstractNode> nodesAt=getNodesAt(n);
        size+=nodesAt.size();
        for (        AbstractNode nodeAt : nodesAt) {
          if (nodeAt != null && securityContext.isReadable(nodeAt,includeDeletedAndHidden,publicOnly)) {
            if (++position > offset) {
              if (++count > pageSize) {
                return new Result(nodes,size,true,false);
              }
              nodes.add((T)nodeAt);
            }
          }
        }
      }
    }
  }
  return new Result(nodes,size,true,false);
}
