{
  final App app=StructrApp.getInstance(securityContext);
  final Iterator<T> iterator=nodes.iterator();
  long objectCount=0L;
  while (iterator.hasNext()) {
    try {
      app.beginTx();
      while (iterator.hasNext()) {
        T node=iterator.next();
        try {
          operation.handleGraphObject(securityContext,node);
        }
 catch (        Throwable t) {
          operation.handleThrowable(securityContext,t,node);
        }
        if ((++objectCount % commitCount) == 0) {
          break;
        }
      }
      app.commitTx();
    }
 catch (    Throwable t) {
      operation.handleTransactionFailure(securityContext,t);
    }
 finally {
      app.finishTx();
    }
    if (description != null) {
      logger.log(Level.INFO,"{0}: {1} objects processed",new Object[]{description,objectCount});
    }
  }
  return objectCount;
}
