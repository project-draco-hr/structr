{
  if (obj != null) {
    Class clazz=obj.getClass();
    String type=typeMap.get(clazz);
    if (type != null) {
      if (clazz.isArray()) {
        Object[] array=(Object[])obj;
        int len=array.length;
        int log=Integer.valueOf(len).toString().length();
        writer.print(type);
        writer.print(log);
        writer.print(len);
        for (        Object o : (Object[])obj) {
          serialize(writer,o);
        }
      }
 else {
        String str=filter(obj.toString());
        int len=str.length();
        int log=Integer.valueOf(len).toString().length();
        writer.print(type);
        writer.print(log);
        writer.print(len);
        writer.print(str);
      }
      writer.print(" ");
    }
 else {
      logger.log(Level.WARNING,"Unable to serialize object of type {0}, type not supported",obj.getClass());
    }
  }
}
