{
  final Configuration configuration=StructrApp.getConfiguration();
  final Map<String,Class<? extends NodeInterface>> nodeEntities=configuration.getNodeEntities();
  final Map<String,Class<? extends RelationshipInterface>> relEntities=configuration.getRelationshipEntities();
  final List<SearchAttribute> attrs=new LinkedList<>();
  if (type == null) {
    Set<Class> classesForInterface=configuration.getClassesForInterface(type.getSimpleName());
    if (classesForInterface != null) {
      for (      Class clazz : classesForInterface) {
        attrs.addAll(getTypeAndSubtypesInternal(clazz,isExactMatch));
      }
    }
    return attrs;
  }
  for (  Map.Entry<String,Class<? extends NodeInterface>> entity : nodeEntities.entrySet()) {
    Class<? extends NodeInterface> entityClass=entity.getValue();
    if (type.isAssignableFrom(entityClass)) {
      attrs.add(Search.orType(entityClass,isExactMatch));
    }
  }
  for (  Map.Entry<String,Class<? extends RelationshipInterface>> entity : relEntities.entrySet()) {
    Class<? extends RelationshipInterface> entityClass=entity.getValue();
    if (type.isAssignableFrom(entityClass)) {
      attrs.add(Search.orType(entityClass,isExactMatch));
    }
  }
  return attrs;
}
