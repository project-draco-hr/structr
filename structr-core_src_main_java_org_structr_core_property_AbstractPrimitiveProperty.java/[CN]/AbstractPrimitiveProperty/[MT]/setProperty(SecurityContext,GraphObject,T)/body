{
  PropertyConverter converter=databaseConverter(securityContext,obj);
  final Object convertedValue;
  if (converter != null) {
    convertedValue=converter.convert(value);
  }
 else {
    convertedValue=value;
  }
  final PropertyContainer propertyContainer=obj.getPropertyContainer();
  if (propertyContainer != null) {
    if (!TransactionCommand.inTransaction()) {
      logger.log(Level.SEVERE,"setProperty outside of transaction, dumping stack.");
      Thread.dumpStack();
      return;
    }
    try {
      if (!isSystemProperty) {
        if (obj instanceof AbstractNode) {
          TransactionCommand.nodeModified((AbstractNode)obj,AbstractPrimitiveProperty.this,propertyContainer.hasProperty(dbName()) ? propertyContainer.getProperty(dbName()) : null);
        }
 else         if (obj instanceof AbstractRelationship) {
          TransactionCommand.relationshipModified((AbstractRelationship)obj,AbstractPrimitiveProperty.this,propertyContainer.hasProperty(dbName()) ? propertyContainer.getProperty(dbName()) : null);
        }
      }
      if (convertedValue == null) {
        propertyContainer.removeProperty(dbName());
      }
 else {
        if (!AbstractPrimitiveProperty.this.equals(AbstractNode.lastModifiedDate)) {
          propertyContainer.setProperty(dbName(),convertedValue);
          propertyContainer.setProperty(AbstractNode.lastModifiedDate.dbName(),System.currentTimeMillis());
        }
 else {
          logger.log(Level.FINE,"Tried to set lastModifiedDate explicitely (action was denied)");
        }
      }
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
 finally {
    }
  }
}
