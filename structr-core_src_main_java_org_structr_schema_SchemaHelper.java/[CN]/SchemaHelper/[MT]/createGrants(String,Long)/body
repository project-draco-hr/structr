{
  List<ResourceAccess> grants=new LinkedList<>();
  final App app=StructrApp.getInstance();
  try {
    app.beginTx();
    ResourceAccess grant=app.nodeQuery(ResourceAccess.class).and(ResourceAccess.signature,signature).getFirst();
    long flagsValue=255;
    if (flags != null) {
      flagsValue=flags.longValue();
    }
    if (grant == null) {
      grants.add(app.create(ResourceAccess.class,new NodeAttribute(ResourceAccess.signature,signature),new NodeAttribute(ResourceAccess.flags,flagsValue)));
      grants.add(app.create(ResourceAccess.class,new NodeAttribute(ResourceAccess.signature,"_schema/" + signature),new NodeAttribute(ResourceAccess.flags,flagsValue)));
      grants.add(app.create(ResourceAccess.class,new NodeAttribute(ResourceAccess.signature,signature + "/_Ui"),new NodeAttribute(ResourceAccess.flags,flagsValue)));
    }
 else {
      grant.setProperty(ResourceAccess.flags,flagsValue);
    }
    app.commitTx();
  }
 catch (  Throwable t) {
    t.printStackTrace();
  }
 finally {
    app.finishTx();
  }
  return grants;
}
