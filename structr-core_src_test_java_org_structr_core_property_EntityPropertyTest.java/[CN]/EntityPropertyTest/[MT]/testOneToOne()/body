{
  final TestSix a=createTestNode(TestSix.class);
  final TestSix c=createTestNode(TestSix.class);
  final TestThree b=createTestNode(TestThree.class);
  final TestThree d=createTestNode(TestThree.class);
  try {
    Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
      @Override public Object execute() throws FrameworkException {
        a.setProperty(AbstractNode.name,"a");
        c.setProperty(AbstractNode.name,"c");
        b.setProperty(AbstractNode.name,"b");
        d.setProperty(AbstractNode.name,"d");
        return null;
      }
    }
);
  }
 catch (  FrameworkException fex) {
    fex.printStackTrace();
    fail("Unable to create test nodes");
  }
  assertNotNull(a);
  assertNotNull(c);
  assertNotNull(b);
  assertNotNull(d);
  try {
    Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
      @Override public Object execute() throws FrameworkException {
        a.setProperty(TestSix.oneToOneTestThree,b);
        c.setProperty(TestSix.oneToOneTestThree,d);
        return null;
      }
    }
);
  }
 catch (  FrameworkException fex) {
    fex.printStackTrace();
    fail("Unable to link test nodes");
  }
  TestThree verifyB=a.getProperty(TestSix.oneToOneTestThree);
  TestThree verifyD=c.getProperty(TestSix.oneToOneTestThree);
  assertTrue(verifyB != null && verifyB.equals(b));
  assertTrue(verifyD != null && verifyD.equals(d));
  try {
    Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
      @Override public Object execute() throws FrameworkException {
        a.setProperty(TestSix.oneToOneTestThree,d);
        return null;
      }
    }
);
    fail("Linking two nodes that are already connected to other nodes via 1:1 relationship should fail.");
  }
 catch (  FrameworkException fex) {
  }
  try {
    Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
      @Override public Object execute() throws FrameworkException {
        c.setProperty(TestSix.oneToOneTestThree,b);
        return null;
      }
    }
);
    fail("Linking two nodes that are already connected to other nodes via 1:1 relationship should fail.");
  }
 catch (  FrameworkException fex) {
  }
  try {
    Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
      @Override public Object execute() throws FrameworkException {
        d.setProperty(TestThree.oneToOneTestSix,a);
        return null;
      }
    }
);
    fail("Linking two nodes that are already connected to other nodes via 1:1 relationship should fail.");
  }
 catch (  FrameworkException fex) {
  }
  try {
    Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
      @Override public Object execute() throws FrameworkException {
        b.setProperty(TestThree.oneToOneTestSix,c);
        return null;
      }
    }
);
    fail("Linking two nodes that are already connected to other nodes via 1:1 relationship should fail.");
  }
 catch (  FrameworkException fex) {
  }
}
