{
  final CloseableHttpClient client=HttpClients.custom().setDefaultConnectionConfig(ConnectionConfig.DEFAULT).setUserAgent("curl/7.35.0").build();
  final SourceSite site=getSite();
  final HttpHost target=HttpHost.create(url);
  final HttpHost proxy=HttpHost.create(site.getProperty(SourceSite.proxyUrl));
  final RequestConfig config=RequestConfig.custom().setProxy(proxy).setRedirectsEnabled(true).setCookieSpec(CookieSpecs.DEFAULT).build();
  final HttpGet request=new HttpGet("/");
  request.setConfig(config);
  if (StringUtils.isNotBlank(cookie)) {
    request.addHeader("Cookie",cookie);
    request.getParams().setParameter("http.protocol.single-cookie-header",true);
  }
  request.addHeader("Connection","close");
  String content="";
  try {
    final CloseableHttpResponse response=client.execute(target,request);
    final Header contentType=response.getFirstHeader("Content-Type");
    String charset=StringUtils.substringAfterLast(contentType.getValue(),"; charset=");
    if (StringUtils.isBlank(charset)) {
      charset="UTF-8";
    }
    content=IOUtils.toString(response.getEntity().getContent(),charset).replace("<head>","<head>\n  <base href=\"" + url + "\">");
  }
 catch (  IOException ex) {
    logger.log(Level.SEVERE,null,ex);
  }
  return content;
}
