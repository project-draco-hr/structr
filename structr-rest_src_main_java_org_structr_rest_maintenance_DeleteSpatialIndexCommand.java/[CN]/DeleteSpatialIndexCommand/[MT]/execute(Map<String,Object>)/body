{
  final GraphDatabaseService graphDb=Services.getService(NodeService.class).getGraphDb();
  final List<Node> toDelete=new LinkedList<>();
  for (  final Node node : GlobalGraphOperations.at(graphDb).getAllNodes()) {
    try {
      if (node.hasProperty("bbox") && node.hasProperty("gtype") && node.hasProperty("id")&& node.hasProperty("latitude")&& node.hasProperty("longitude")) {
        toDelete.add(node);
      }
    }
 catch (    Throwable t) {
    }
  }
  final App app=StructrApp.getInstance(securityContext);
  try {
    app.beginTx();
    for (    Node node : toDelete) {
      logger.log(Level.INFO,"Deleting node {0}",node);
      try {
        for (        Relationship rel : node.getRelationships()) {
          rel.delete();
        }
        node.delete();
      }
 catch (      Throwable t) {
        t.printStackTrace();
      }
    }
    app.commitTx();
  }
  finally {
    app.finishTx();
  }
}
