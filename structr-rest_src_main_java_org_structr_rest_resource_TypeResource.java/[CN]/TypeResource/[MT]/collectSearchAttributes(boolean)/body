{
  final List<SearchAttribute> searchAttributes=new LinkedList<>();
  final List<SearchAttribute> validAttributes=extractSearchableAttributes(securityContext,entityClass,request);
  final DistanceSearchAttribute distanceSearch=getDistanceSearch(request,keys(validAttributes));
  if (distanceSearch != null) {
    searchAttributes.add(distanceSearch);
  }
  if (entityClass != null) {
    searchAttributes.add(Search.andTypeAndSubtypes(entityClass,!inexactSearch));
  }
  searchAttributes.addAll(validAttributes);
  return searchAttributes;
}
