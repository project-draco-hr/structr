{
  JsonInputGSONAdapter jsonInputAdapter=new JsonInputGSONAdapter(propertyView,config.getDefaultIdProperty());
  ResultGSONAdapter resultGsonAdapter=new ResultGSONAdapter(propertyView,config.getDefaultIdProperty(),outputNestingDepth);
  final GsonBuilder gsonBuilder=new GsonBuilder().setPrettyPrinting().serializeNulls().registerTypeHierarchyAdapter(FrameworkException.class,new FrameworkExceptionGSONAdapter()).registerTypeAdapter(JsonInput.class,jsonInputAdapter).registerTypeAdapter(Result.class,resultGsonAdapter);
  final boolean lenient=Boolean.parseBoolean(StructrApp.getConfigurationValue("json.lenient","false"));
  if (lenient) {
    gsonBuilder.serializeSpecialFloatingPointValues();
  }
  return gsonBuilder.create();
}
