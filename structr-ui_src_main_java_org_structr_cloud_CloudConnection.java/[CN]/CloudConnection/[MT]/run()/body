{
  while (isConnected()) {
    try {
      final Message request=receiver.receive();
      if (request != null) {
        sender.messageReceived();
        refreshTransmissionTimeout();
        if (wasSentFromHere(request)) {
          request.onResponse(this,context);
        }
 else {
          request.onRequest(this,context);
        }
        if (CloudService.DEBUG) {
          System.out.println("        => " + request);
        }
      }
      Thread.yield();
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
  }
  shutdown();
  logger.log(Level.INFO,"Transmission finished");
}
