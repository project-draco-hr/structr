{
  FileNodeDataContainer container=new FileNodeDataContainer(file);
  client.send(container);
  context.progress();
  for (  FileNodeChunk chunk : FileNodeDataContainer.getChunks(file,chunkSize)) {
    client.send(chunk);
    context.progress();
    client.waitForMessage();
  }
  client.send(new FileNodeEndChunk(container.getSourceNodeId(),container.getFileSize()));
  context.progress();
  client.waitForMessage();
}
