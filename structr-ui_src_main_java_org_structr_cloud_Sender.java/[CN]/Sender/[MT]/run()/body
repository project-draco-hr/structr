{
  while (isConnected()) {
    try {
      final Message message=outputQueue.poll();
      if (message != null) {
        outputStream.writeObject(message);
        outputStream.flush();
      }
    }
 catch (    IOException ioex) {
      errorMessage=ioex;
      finish();
    }
  }
}
