{
  while (connection.isConnected()) {
    try {
      final Message message=outputQueue.poll();
      if (message != null) {
        if (CloudService.DEBUG) {
          System.out.println("Sender: " + message);
        }
        outputStream.writeObject(message);
        outputStream.flush();
        message.postProcess(connection,null);
      }
    }
 catch (    Throwable t) {
      errorMessage=t;
      connection.shutdown();
    }
  }
}
