{
  while (receiver.isConnected() && sender.isConnected()) {
    try {
      final Message request=receiver.receive();
      if (request != null) {
        final Message response=request.process(this);
        if (response != null) {
          sender.send(response);
          response.postProcess(this);
        }
      }
      Thread.sleep(1);
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
  }
  shutdown();
}
