{
  final Principal user=context.getUser(userName);
  if (user != null) {
    try {
      this.keyLength=Math.min(keyLength,Cipher.getMaxAllowedKeyLength(CloudService.STREAM_CIPHER));
      this.encryptionKey=user.getEncryptedPassword();
      this.salt=user.getProperty(Principal.salt);
      context.impersonateUser(user);
      return this;
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
  }
  context.endTransaction();
  connection.closeConnection();
  return null;
}
