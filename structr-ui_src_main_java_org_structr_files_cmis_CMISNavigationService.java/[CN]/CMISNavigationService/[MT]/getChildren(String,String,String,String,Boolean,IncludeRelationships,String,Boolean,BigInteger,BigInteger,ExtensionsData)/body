{
  final App app=StructrApp.getInstance();
  if (folderId != null && folderId.equals(CMISInfo.ROOT_FOLDER_ID)) {
    try (final Tx tx=app.tx()){
      final CMISObjectInFolderWrapper wrapper=new CMISObjectInFolderWrapper(includeAllowableActions,maxItems,skipCount);
      wrapper.wrap(app.nodeQuery(AbstractFile.class).and(Folder.parent,null).sort(AbstractNode.name).getAsList());
      tx.success();
      return wrapper;
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
  }
 else {
    try (final Tx tx=app.tx()){
      final Folder parent=app.get(Folder.class,folderId);
      CMISObjectInFolderWrapper wrapper=null;
      if (parent != null) {
        final List<AbstractFile> children=parent.getProperty(AbstractFile.children);
        wrapper=new CMISObjectInFolderWrapper(includeAllowableActions,maxItems,skipCount);
        Collections.sort(children,new GraphObjectComparator(AbstractNode.name,false));
        wrapper.wrap(children);
      }
      tx.success();
      return wrapper;
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
  }
  throw new CmisObjectNotFoundException("Folder with ID " + folderId + " does not exist");
}
