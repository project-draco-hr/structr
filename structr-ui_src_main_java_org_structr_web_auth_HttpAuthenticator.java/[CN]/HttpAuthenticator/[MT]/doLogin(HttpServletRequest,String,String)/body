{
  Principal user=AuthHelper.getPrincipalForPassword(Person.eMail,emailOrUsername,password);
  if (user == null) {
    user=AuthHelper.getPrincipalForPassword(AbstractNode.name,emailOrUsername,password);
  }
  if (user != null) {
    final String sessionIdFromRequest=request.getRequestedSessionId();
    final Principal principal=user;
    AuthHelper.clearSession(sessionIdFromRequest);
    principal.addSessionId(sessionIdFromRequest);
  }
  return user;
}
