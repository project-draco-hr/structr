{
  if (examined) {
    return;
  }
  Principal user=checkSessionAuthentication(request,response);
  if (user != null) {
    securityContext.setUser(user);
    return;
  }
  user=checkExternalAuthentication(securityContext,request,response);
  if (user != null) {
    securityContext.setUser(user);
  }
  examined=true;
}
