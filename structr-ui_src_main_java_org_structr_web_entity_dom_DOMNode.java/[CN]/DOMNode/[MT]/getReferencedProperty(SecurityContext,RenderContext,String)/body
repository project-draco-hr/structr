{
  String pageId=renderContext.getPageId();
  String[] parts=refKey.split("[\\.]+");
  String referenceKey=parts[parts.length - 1];
  PropertyKey pageIdProperty=new StringProperty(pageId);
  PropertyKey referenceKeyProperty=new StringProperty(referenceKey);
  Page _page=renderContext.getPage();
  GraphObject _data=null;
  for (int i=0; (i < parts.length); i++) {
    String part=parts[i];
    if ("request".equals(part.toLowerCase())) {
      HttpServletRequest request=securityContext.getRequest();
      if (request != null) {
        return StringUtils.defaultString(request.getParameter(referenceKey));
      }
    }
    if ("resource".equals(part.toLowerCase())) {
      _data=PageHelper.getNodeById(securityContext,pageId);
      continue;
    }
    if ("page".equals(part.toLowerCase())) {
      _data=_page;
      continue;
    }
    if ("link".equals(part.toLowerCase())) {
      for (      AbstractRelationship rel : getRelationships(RelType.LINK,Direction.OUTGOING)) {
        _data=rel.getEndNode();
        break;
      }
      continue;
    }
    if ("parent".equals(part.toLowerCase())) {
      for (      AbstractRelationship rel : getRelationships(RelType.CONTAINS,Direction.INCOMING)) {
        if (rel.getProperty(pageIdProperty) != null) {
          _data=rel.getStartNode();
          break;
        }
      }
      continue;
    }
    if ("owner".equals(part.toLowerCase())) {
      for (      AbstractRelationship rel : getRelationships(RelType.OWNS,Direction.INCOMING)) {
        _data=rel.getStartNode();
        break;
      }
      continue;
    }
    if ("data".equals(part.toLowerCase())) {
      _data=renderContext.getCurrentDataNode();
      continue;
    }
    if ("result_size".equals(part.toLowerCase())) {
      Set<Page> pages=getResultPages(securityContext,(Page)_page);
      if (!pages.isEmpty()) {
        return pages.size();
      }
      return 0;
    }
    if ("rest_result".equals(part.toLowerCase())) {
      HttpServletRequest request=securityContext.getRequest();
      if (request != null) {
        return StringEscapeUtils.escapeJavaScript(StringUtils.replace(StringUtils.defaultString((String)request.getAttribute(HtmlServlet.REST_RESPONSE)),"\n",""));
      }
      return 0;
    }
  }
  if (_data != null) {
    return _data.getProperty(referenceKeyProperty);
  }
  return null;
}
