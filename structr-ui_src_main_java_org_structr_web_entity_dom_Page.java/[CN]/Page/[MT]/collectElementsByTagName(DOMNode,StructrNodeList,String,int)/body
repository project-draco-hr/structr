{
  if (startNode instanceof DOMElement) {
    if (tagName.equals(startNode.getProperty(DOMElement.tag))) {
      results.add(startNode);
    }
    NodeList _children=startNode.getChildNodes();
    int len=_children.getLength();
    for (int i=0; i < len; i++) {
      DOMNode child=(DOMNode)_children.item(i);
      collectElementsByTagName(child,results,tagName,depth + 1);
    }
  }
}
