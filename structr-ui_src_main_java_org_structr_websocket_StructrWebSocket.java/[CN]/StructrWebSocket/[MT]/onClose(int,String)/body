{
  logger.log(Level.INFO,"Connection closed with closeCode {0} and message {1}",new Object[]{closeCode,message});
  final App app=StructrApp.getInstance(securityContext);
  try (final Tx tx=app.tx()){
    this.token=null;
    this.connection=null;
    syncController.unregisterClient(this);
    for (    FileUploadHandler upload : uploads.values()) {
      upload.finish();
    }
    tx.success();
  }
 catch (  FrameworkException fex) {
    logger.log(Level.SEVERE,"Error while closing connection",fex);
  }
  uploads.clear();
}
