{
  logger.log(Level.FINE,"Connection closed with closeCode {0} and message {1}",new Object[]{closeCode,message});
  final App app=StructrApp.getInstance(securityContext);
  try (final Tx tx=app.tx()){
    this.session=null;
    syncController.unregisterClient(this);
    for (    FileUploadHandler upload : uploads.values()) {
      upload.finish();
    }
    tx.success();
    uploads.clear();
  }
 catch (  FrameworkException fex) {
    logger.log(Level.SEVERE,"Error while closing connection",fex);
  }
}
