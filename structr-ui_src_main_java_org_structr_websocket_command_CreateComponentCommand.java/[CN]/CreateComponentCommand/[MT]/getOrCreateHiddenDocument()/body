{
  SecurityContext securityContext=SecurityContext.getSuperUserInstance();
  Result result=(Result)Services.command(securityContext,SearchNodeCommand.class).execute(Search.andExactType(ShadowDocument.class));
  if (result.isEmpty()) {
    final CreateNodeCommand cmd=Services.command(securityContext,CreateNodeCommand.class);
    final PropertyMap properties=new PropertyMap();
    properties.put(AbstractNode.type,ShadowDocument.class.getSimpleName());
    properties.put(AbstractNode.name,"__ShadowDocument__");
    properties.put(AbstractNode.hidden,true);
    properties.put(AbstractNode.visibleToAuthenticatedUsers,true);
    ShadowDocument doc=Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction<ShadowDocument>(){
      @Override public ShadowDocument execute() throws FrameworkException {
        return (ShadowDocument)cmd.execute(properties);
      }
    }
);
    return doc;
  }
  return (ShadowDocument)result.get(0);
}
