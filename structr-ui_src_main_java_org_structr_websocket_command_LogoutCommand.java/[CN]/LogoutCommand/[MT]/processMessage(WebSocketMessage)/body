{
  final Principal user=getWebSocket().getCurrentUser();
  if (user != null) {
    final String sessionId=webSocketData.getSessionId();
    if (sessionId != null) {
      SessionHelper.clearSession(sessionId);
      SessionHelper.invalidateSessionId(sessionId);
    }
    Actions.call(Actions.NOTIFICATION_LOGOUT,user);
    getWebSocket().setAuthenticated(null,null);
    getWebSocket().send(MessageBuilder.status().code(401).build(),true);
  }
}
