{
  final SecurityContext securityContext=getWebSocket().getSecurityContext();
  String id=webSocketData.getId();
  if (id != null) {
    final NodeInterface node=getNode(id);
    if (node != null) {
      App app=StructrApp.getInstance(securityContext);
      if (node instanceof DOMNode) {
        DOMNode domNode=(DOMNode)node;
        domNode.getParentNode().removeChild(domNode);
        try {
          domNode.setProperty(DOMNode.pageId,null);
        }
 catch (        FrameworkException ex) {
          logger.log(Level.SEVERE,"Could not remove node from page " + domNode,ex);
        }
      }
 else {
        try {
          app.beginTx();
          for (          AbstractRelationship rel : node.getIncomingRelationships()) {
            try {
              if ("CONTAINS".equals(rel.getType())) {
                app.delete(rel);
              }
            }
 catch (            FrameworkException ex) {
              logger.log(Level.SEVERE,"Could not remove relationship " + rel,ex);
            }
          }
          app.commitTx();
        }
 catch (        Throwable t) {
          getWebSocket().send(MessageBuilder.status().code(400).message("Error in RemoveCommand: " + t.getMessage()).build(),true);
        }
 finally {
          app.finishTx();
        }
      }
    }
 else {
      getWebSocket().send(MessageBuilder.status().code(404).build(),true);
    }
  }
 else {
    getWebSocket().send(MessageBuilder.status().code(400).message("RemoveCommand called with empty id").build(),true);
  }
}
