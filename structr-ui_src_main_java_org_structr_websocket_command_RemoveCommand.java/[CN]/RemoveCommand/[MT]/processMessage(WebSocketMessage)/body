{
  final SecurityContext securityContext=getWebSocket().getSecurityContext();
  String id=webSocketData.getId();
  if (id != null) {
    final NodeInterface node=getNode(id);
    if (node != null) {
      if (node instanceof DOMNode) {
        DOMNode domNode=(DOMNode)node;
        domNode.getParentNode().removeChild(domNode);
        try {
          domNode.setProperty(DOMNode.syncedNodes,Collections.EMPTY_LIST);
          domNode.setProperty(DOMNode.pageId,null);
        }
 catch (        FrameworkException ex) {
          logger.log(Level.SEVERE,"Could not remove node from page " + domNode,ex);
        }
      }
 else {
        final App app=StructrApp.getInstance(securityContext);
        try {
          for (          AbstractRelationship rel : node.getIncomingRelationships()) {
            if ("CONTAINS".equals(rel.getType())) {
              app.delete(rel);
            }
          }
        }
 catch (        Throwable t) {
          getWebSocket().send(MessageBuilder.status().code(400).message("Error in RemoveCommand: " + t.getMessage()).build(),true);
        }
      }
    }
 else {
      getWebSocket().send(MessageBuilder.status().code(404).build(),true);
    }
  }
 else {
    getWebSocket().send(MessageBuilder.status().code(400).message("RemoveCommand called with empty id").build(),true);
  }
}
