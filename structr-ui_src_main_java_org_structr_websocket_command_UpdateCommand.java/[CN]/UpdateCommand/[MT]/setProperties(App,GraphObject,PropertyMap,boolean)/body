{
  if (tx == null) {
    tx=app.tx();
  }
  for (  Entry<PropertyKey,Object> entry : properties.entrySet()) {
    PropertyKey key=entry.getKey();
    Object value=entry.getValue();
    obj.setProperty(key,value);
  }
  if (count++ > 1000) {
    logger.log(Level.INFO,"Committing transaction after {0} objects..",count);
    count=0;
    tx.success();
    tx.close();
    tx=app.tx();
  }
  if (rec && obj instanceof LinkedTreeNode) {
    LinkedTreeNode node=(LinkedTreeNode)obj;
    for (    Object child : node.treeGetChildren()) {
      setProperties(app,(GraphObject)child,properties,true);
    }
  }
}
