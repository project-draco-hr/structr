{
  EntityContext.registerFactoryDefinition(new UiFactoryDefinition());
  try {
    AbstractNode node=createTestNodes("unknown",1).get(0);
    String uuid=node.getUuid();
    assertNotNull(uuid);
    assertEquals(GenericNode.class,node.getClass());
    TypeDefinition def=createTestNodes(TypeDefinition.class,1).get(0);
    Services.command(securityContext,CreateRelationshipCommand.class).execute(def,node,RelType.DEFINES_TYPE);
    Result<AbstractNode> result=Services.command(securityContext,SearchNodeCommand.class).execute(Search.andExactUuid(uuid));
    assertEquals(new Integer(1),result.getRawResultCount());
    AbstractNode foundNode=result.get(0);
    assertEquals(DataNode.class,foundNode.getClass());
  }
 catch (  FrameworkException fex) {
    fail("Unexpected exception: " + fex.toString());
  }
}
