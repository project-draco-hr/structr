{
  String name=null;
  try (final Tx tx=app.tx()){
    final List<Folder> folders=createTestNodes(Folder.class,7);
    final List<File> files=createTestNodes(File.class,7);
    final Page doc=(Page)getDocument();
    name=doc.getName();
    assertEquals(7,folders.size());
    Folder rootNode=folders.get(0);
    rootNode.setProperty(AbstractNode.name,"rootNode");
    Folder folderA=folders.get(1);
    folderA.setProperty(AbstractNode.name,"folderA");
    Folder folderB=folders.get(2);
    folderB.setProperty(AbstractNode.name,"folderB");
    Folder folderC=folders.get(3);
    folderC.setProperty(AbstractNode.name,"folderC");
    Folder folderD=folders.get(4);
    folderD.setProperty(AbstractNode.name,"folderD");
    Folder folderE=folders.get(5);
    folderE.setProperty(AbstractNode.name,"folderE");
    Folder folderF=folders.get(6);
    folderF.setProperty(AbstractNode.name,"folderF");
    File file1=files.get(0);
    file1.setProperty(AbstractNode.name,"file1");
    File file2=files.get(1);
    file2.setProperty(AbstractNode.name,"file2");
    File file3=files.get(2);
    file3.setProperty(AbstractNode.name,"file3");
    File file4=files.get(3);
    file4.setProperty(AbstractNode.name,"file4");
    File file5=files.get(4);
    file5.setProperty(AbstractNode.name,"file5");
    File file6=files.get(5);
    file6.setProperty(AbstractNode.name,"file6");
    File file7=files.get(6);
    file7.setProperty(AbstractNode.name,"file7");
    rootNode.treeAppendChild(folderA);
    rootNode.treeAppendChild(folderB);
    rootNode.treeAppendChild(file1);
    rootNode.treeAppendChild(file2);
    folderA.treeAppendChild(folderC);
    folderA.treeAppendChild(folderD);
    folderA.treeAppendChild(file3);
    folderA.treeAppendChild(file4);
    folderB.treeAppendChild(folderE);
    folderB.treeAppendChild(folderF);
    folderB.treeAppendChild(file5);
    folderB.treeAppendChild(file6);
    makePublic(rootNode,folderA,folderB,folderC,folderD,folderE,folderF);
    makePublic(file1,file2,file3,file4,file5,file6,file7);
    Element html=doc.createElement("html");
    doc.appendChild(html);
    Element body=doc.createElement("body");
    html.appendChild(body);
    final Element div=doc.createElement("div");
    body.appendChild(div);
    Content rootNameContent=(Content)doc.createTextNode("${root.name}");
    div.appendChild(rootNameContent);
    final Element ul1=doc.createElement("ul");
    div.appendChild(ul1);
    final Element li1=doc.createElement("li");
    ul1.appendChild(li1);
    Content foldersNameContent=(Content)doc.createTextNode("${folders.name}");
    li1.appendChild(foldersNameContent);
    final Element li2=doc.createElement("li");
    ul1.appendChild(li2);
    Content filesNameContent=(Content)doc.createTextNode("${files.name}");
    li2.appendChild(filesNameContent);
    final Element ul2=doc.createElement("ul");
    li1.appendChild(ul2);
    final Element li3=doc.createElement("li");
    ul2.appendChild(li3);
    Content files2NameContent=(Content)doc.createTextNode("${files.name}");
    li3.appendChild(files2NameContent);
    final Element li4=doc.createElement("li");
    ul2.appendChild(li4);
    Content folders2NameContent=(Content)doc.createTextNode("${folders.name}");
    li4.appendChild(folders2NameContent);
    makePublic(rootNameContent,foldersNameContent,filesNameContent,files2NameContent,folders2NameContent);
    PropertyMap properties=new PropertyMap();
    StructrApp.getInstance(securityContext).command(CreateRelationshipCommand.class).execute((DOMElement)div,(NodeInterface)rootNode,RenderNode.class,properties);
    ((DOMElement)div).setProperty(DOMElement.dataKey,"root");
    ((DOMElement)li1).setProperty(DOMElement.dataKey,"folders");
    ((DOMElement)li2).setProperty(DOMElement.dataKey,"files");
    ((DOMElement)li3).setProperty(DOMElement.dataKey,"files");
    ((DOMElement)li4).setProperty(DOMElement.dataKey,"folders");
    makePublic(doc,html,body,div,ul1,ul2,li1,li2,li3,li4);
    tx.success();
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    fail("Unexpected exception");
  }
  try (final Tx tx=app.tx()){
    org.jsoup.nodes.Document parsedDocument=Jsoup.connect(baseUri + name).get();
    System.out.println(parsedDocument);
    assertEquals("rootNode",parsedDocument.select("html > body > div").get(0).ownText());
    assertEquals("folderA",parsedDocument.select("html > body > div > ul > li").get(0).ownText());
    assertEquals("folderB",parsedDocument.select("html > body > div > ul > li").get(1).ownText());
    assertEquals("file1",parsedDocument.select("html > body > div > ul > li").get(2).ownText());
    assertEquals("file2",parsedDocument.select("html > body > div > ul > li").get(3).ownText());
    assertEquals("file3",parsedDocument.select("html > body > div > ul > li > ul > li").get(0).ownText());
    assertEquals("file4",parsedDocument.select("html > body > div > ul > li > ul > li").get(1).ownText());
    assertEquals("folderC",parsedDocument.select("html > body > div > ul > li > ul > li").get(2).ownText());
    assertEquals("folderD",parsedDocument.select("html > body > div > ul > li > ul > li").get(3).ownText());
    assertEquals("file5",parsedDocument.select("html > body > div > ul > li").get(1).child(0).child(0).ownText());
    assertEquals("file6",parsedDocument.select("html > body > div > ul > li").get(1).child(0).child(1).ownText());
    assertEquals("folderE",parsedDocument.select("html > body > div > ul > li").get(1).child(0).child(2).ownText());
    assertEquals("folderF",parsedDocument.select("html > body > div > ul > li").get(1).child(0).child(3).ownText());
    tx.success();
  }
 catch (  Exception ex) {
    ex.printStackTrace();
    fail("unexpected exception");
  }
}
