{
  Date now=new Date();
  PageRequest pageRequest=new PageRequest();
  pageRequest.setProperty(StructrNode.TYPE_KEY,PageRequest.class.getSimpleName());
  pageRequest.setProperty(StructrNode.NAME_KEY,"Action: " + action + ", Date: "+ now);
  if (request != null) {
    pageRequest.setProperty(PageRequest.URI_KEY,request.getRequestURI());
    pageRequest.setProperty(PageRequest.REMOTE_ADDRESS_KEY,request.getRemoteAddr());
    pageRequest.setProperty(PageRequest.REMOTE_HOST_KEY,request.getRemoteHost());
  }
  pageRequest.setProperty(Activity.SESSION_ID_KEY,sessionId);
  pageRequest.setProperty(Activity.START_TIMESTAMP_KEY,now);
  pageRequest.setProperty(Activity.END_TIMESTAMP_KEY,now);
  pageRequest.setUser(user);
  getSession(sessionId).setLastActivity(pageRequest);
  Services.createCommand(LogCommand.class).execute(pageRequest);
}
