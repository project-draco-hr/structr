{
  Date now=new Date();
  User user=CurrentRequest.getCurrentUser();
  PageRequest pageRequest=new PageRequest();
  pageRequest.setProperty(AbstractNode.TYPE_KEY,PageRequest.class.getSimpleName());
  pageRequest.setProperty(AbstractNode.NAME_KEY,"Action: " + action + ", Date: "+ now);
  if (request != null) {
    pageRequest.setProperty(PageRequest.URI_KEY,request.getRequestURI());
    pageRequest.setProperty(PageRequest.REMOTE_ADDRESS_KEY,request.getRemoteAddr());
    pageRequest.setProperty(PageRequest.REMOTE_HOST_KEY,request.getRemoteHost());
  }
  pageRequest.setProperty(Activity.SESSION_ID_KEY,sessionId);
  pageRequest.setProperty(Activity.START_TIMESTAMP_KEY,now);
  pageRequest.setProperty(Activity.END_TIMESTAMP_KEY,now);
  pageRequest.setUser(user);
  getSession(sessionId).setLastActivity(pageRequest);
  Services.command(LogCommand.class).execute(pageRequest);
}
