{
  CurrentRequest.setRequest(getContext().getRequest());
  CurrentRequest.setResponse(getContext().getResponse());
  CurrentRequest.setCurrentNodePath(nodeId);
  super.onInit();
  if (user != null) {
    sessionId=(Long)getContext().getRequest().getSession().getAttribute(SessionMonitor.SESSION_ID);
    SessionMonitor.logPageRequest(sessionId,"Page Request",getContext().getRequest());
  }
  node=getNodeByIdOrPath(nodeId);
  if (node == null) {
    return;
  }
  nodeId=node.getIdString();
  if (isSuperUser) {
    readAllowed=true;
    showTreeAllowed=true;
    writeAllowed=true;
    accessControlAllowed=true;
    createNodeAllowed=true;
    deleteNodeAllowed=true;
    editPropertiesAllowed=true;
    editVisibilityAllowed=true;
    addRelationshipAllowed=true;
    removeRelationshipAllowed=true;
  }
 else   if (user != null && node != null) {
    readAllowed=node.readAllowed();
    showTreeAllowed=node.showTreeAllowed();
    writeAllowed=node.writeAllowed();
    accessControlAllowed=node.accessControlAllowed();
    createNodeAllowed=node.createSubnodeAllowed();
    deleteNodeAllowed=node.deleteNodeAllowed();
    editPropertiesAllowed=node.editPropertiesAllowed();
    editVisibilityAllowed=node.editPropertiesAllowed();
    addRelationshipAllowed=node.addRelationshipAllowed();
    removeRelationshipAllowed=node.removeRelationshipAllowed();
  }
  CurrentRequest.onRequestStart();
}
