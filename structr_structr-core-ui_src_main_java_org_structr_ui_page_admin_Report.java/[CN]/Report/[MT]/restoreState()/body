{
  Context context=getContext();
  if (context.hasSessionAttribute(REPORT_RESULTS_KEY)) {
    reportForm.add(resultTypeSelect);
    reportResults=(List<AbstractNode>)context.getSessionAttribute(REPORT_RESULTS_KEY);
    resultTypeSelect.restoreState(context);
    columns=(List<Column>)context.getSessionAttribute(REPORT_COLUMNS_KEY);
    if (columns != null) {
      for (      Column c : columns) {
        reportTable.addColumn(c);
        String fieldName=c.getName();
        TextField field=new TextField(fieldName);
        propertyFields.add(field);
        Checkbox checkbox=new Checkbox(checkBoxName(fieldName),"");
        propertyFields.add(checkbox);
      }
    }
 else {
      columns=new LinkedList<Column>();
    }
    reportForm.add(propertyFields);
    reportForm.restoreState(context);
    if (columns != null) {
      for (      Column c : columns) {
        String fieldName=c.getName();
        String fieldValue=reportForm.getFieldValue(fieldName);
        searchAttributes.add(new TextualSearchAttribute(fieldName,fieldValue,SearchOperator.AND));
      }
    }
 else {
      columns=new LinkedList<Column>();
    }
    reportTable.restoreState(context);
  }
}
