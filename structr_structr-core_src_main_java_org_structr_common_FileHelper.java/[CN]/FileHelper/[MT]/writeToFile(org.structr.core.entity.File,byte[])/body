{
  String uuid=fileNode.getStringProperty(AbstractNode.Key.uuid);
  if (uuid == null) {
synchronized (fileNode) {
      uuid=UUID.randomUUID().toString().replaceAll("[\\-]+","");
      fileNode.setProperty(AbstractNode.Key.uuid.name(),uuid);
    }
  }
  fileNode.setRelativeFilePath(org.structr.core.entity.File.getDirectoryPath(uuid) + "/" + uuid);
  java.io.File fileOnDisk=new java.io.File(Services.getFilesPath() + "/" + fileNode.getRelativeFilePath());
  fileOnDisk.getParentFile().mkdirs();
  FileUtils.writeByteArrayToFile(fileOnDisk,data);
}
