{
  if (isSuperUser()) {
    return true;
  }
  user=getUser();
  if (user != null && (user.equals(node) || user.equals(node.getOwnerNode()))) {
    return true;
  }
  boolean isAllowed=false;
switch (accessMode) {
case Backend:
    isAllowed=isAllowedInBackend(node,permission);
  break;
case Frontend:
isAllowed=isAllowedInFrontend(node,permission);
break;
}
if (node != null) {
logger.log(Level.FINEST,"Returning {0} for user {1}, access mode {2}, node {3}, permission {4}",new Object[]{isAllowed,(user != null) ? user.getName() : "null",accessMode,node,permission});
}
return isAllowed;
}
