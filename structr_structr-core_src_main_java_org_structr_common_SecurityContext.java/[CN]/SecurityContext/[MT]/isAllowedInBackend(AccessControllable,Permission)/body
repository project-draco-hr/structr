{
  User user=getUser();
  if (node == null) {
    return false;
  }
  if ((user != null) && (user instanceof SuperUser)) {
    return true;
  }
switch (permission) {
case AccessControl:
    if (user == null) {
      return false;
    }
  if (user instanceof SuperUser) {
    return true;
  }
if (node.equals(user)) {
  return true;
}
StructrRelationship r=null;
if (user.equals(node.getOwnerNode())) {
return true;
}
r=node.getSecurityRelationship(user);
if ((r != null) && r.isAllowed(StructrRelationship.Permission.accessControl.name())) {
return true;
}
return false;
case CreateNode:
return node.hasPermission(StructrRelationship.Permission.createNode.name(),user);
case CreateRelationship:
return node.hasPermission(StructrRelationship.Permission.addRelationship.name(),user);
case DeleteNode:
return node.hasPermission(StructrRelationship.Permission.deleteNode.name(),user);
case DeleteRelationship:
return node.hasPermission(StructrRelationship.Permission.removeRelationship.name(),user);
case EditProperty:
return node.hasPermission(StructrRelationship.Permission.editProperties.name(),user);
case Execute:
return node.hasPermission(StructrRelationship.Permission.execute.name(),user);
case Read:
return node.hasPermission(StructrRelationship.Permission.read.name(),user);
case ShowTree:
return node.hasPermission(StructrRelationship.Permission.showTree.name(),user);
case Write:
return node.hasPermission(StructrRelationship.Permission.write.name(),user);
}
return (false);
}
