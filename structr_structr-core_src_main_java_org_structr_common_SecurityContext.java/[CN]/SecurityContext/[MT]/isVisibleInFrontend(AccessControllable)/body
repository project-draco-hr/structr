{
  if (node == null) {
    return false;
  }
  if (node.isHidden()) {
    return false;
  }
  if (node.isVisibleToPublicUsers()) {
    return true;
  }
  if (node.isVisibleToAuthenticatedUsers()) {
    Principal user=getUser();
    if (user != null) {
      if (user instanceof SuperUser) {
        return true;
      }
      if (user.isFrontendUser()) {
        boolean hasReadPermission=node.hasPermission(AbstractRelationship.Permission.read.name(),user);
        if (!hasReadPermission) {
          response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);
        }
        return hasReadPermission;
      }
    }
  }
  return false;
}
