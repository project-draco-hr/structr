{
  SecurityContext securityContext=out.getSecurityContext();
  if (securityContext.isVisible(currentNode)) {
    String html=currentNode.getContent();
    if (StringUtils.isNotBlank(html)) {
      StringWriter content=new StringWriter();
      currentNode.replaceByFreeMarker(out.getRequest(),html,content,startNode,editUrl,editNodeId);
      StringBuilder content2=new StringBuilder(content.toString());
      try {
        currentNode.replaceBySubnodes(out.getRequest(),content2,startNode,editUrl,editNodeId);
        out.append(content2.toString());
      }
 catch (      FrameworkException fex) {
        logger.log(Level.WARNING,"Unable to replace content",fex);
      }
    }
  }
}
