{
  this.currentNode=currentNode;
  this.securityContext=securityContext;
  try {
    Command graphDbCommand=Services.command(securityContext,GraphDatabaseCommand.class);
    this.db=(GraphDatabaseService)graphDbCommand.execute();
    if (context == null) {
      Node rootNode=db.getReferenceNode();
      context=JXPathContextReferenceImpl.newContext(rootNode);
      if (currentNode != null && !(currentNode.isRootNode())) {
        Pointer currentNodePointer=context.getPointer(currentNode.getNodeXPath());
        context=context.getRelativeContext(currentNodePointer);
      }
    }
  }
 catch (  FrameworkException fex) {
    fex.printStackTrace();
  }
}
