{
  logger.log(Level.INFO,"Servlet context created");
  Map<String,Object> context=new ConcurrentHashMap<String,Object>();
  ServletContext servletContext=sce.getServletContext();
  String configFile=servletContext.getInitParameter(Services.CONFIG_FILE_PATH);
  context.put(Services.CONFIG_FILE_PATH,configFile);
  context.put(Services.SERVLET_CONTEXT,servletContext);
  try {
    Properties properties=new Properties();
    properties.load(new FileInputStream(configFile));
    String appTitle=properties.getProperty(Services.APPLICATION_TITLE);
    logger.log(Level.INFO,"Config file application title: {0}",appTitle);
    String tmpPath=properties.getProperty(Services.TMP_PATH);
    logger.log(Level.INFO,"Config file temp path: {0}",tmpPath);
    String databasePath=properties.getProperty(Services.DATABASE_PATH);
    logger.log(Level.INFO,"Config file database path: {0}",databasePath);
    String filesPath=properties.getProperty(Services.FILES_PATH);
    logger.log(Level.INFO,"Config file files path: {0}",filesPath);
    String modulesPath=properties.getProperty(Services.MODULES_PATH);
    logger.log(Level.INFO,"Config file modules path: {0}",modulesPath);
    String serverIp=properties.getProperty(Services.SERVER_IP);
    logger.log(Level.INFO,"Config file server IP: {0}",serverIp);
    String tcpPort=properties.getProperty(Services.TCP_PORT);
    logger.log(Level.INFO,"Config file TCP port: {0}",tcpPort);
    String udpPort=properties.getProperty(Services.UDP_PORT);
    logger.log(Level.INFO,"Config file UDP port: {0}",udpPort);
    String superuserUsername=properties.getProperty(Services.SUPERUSER_USERNAME);
    logger.log(Level.INFO,"Config file superuser username: {0}",superuserUsername);
    String superuserPassword=properties.getProperty(Services.SUPERUSER_PASSWORD);
    logger.log(Level.INFO,"Config file superuser password: {0}",superuserPassword);
    if (appTitle != null) {
      context.put(Services.APPLICATION_TITLE,appTitle);
    }
 else {
      context.put(Services.APPLICATION_TITLE,servletContext.getInitParameter(Services.APPLICATION_TITLE));
    }
    if (tmpPath != null) {
      context.put(Services.TMP_PATH,tmpPath);
    }
 else {
      context.put(Services.TMP_PATH,servletContext.getInitParameter(Services.TMP_PATH));
    }
    if (databasePath != null) {
      context.put(Services.DATABASE_PATH,databasePath);
    }
 else {
      context.put(Services.DATABASE_PATH,servletContext.getInitParameter(Services.DATABASE_PATH));
    }
    if (filesPath != null) {
      context.put(Services.FILES_PATH,filesPath);
    }
 else {
      context.put(Services.FILES_PATH,servletContext.getInitParameter(Services.FILES_PATH));
    }
    if (modulesPath != null) {
      context.put(Services.MODULES_PATH,modulesPath);
    }
 else {
      context.put(Services.MODULES_PATH,servletContext.getInitParameter(Services.MODULES_PATH));
    }
    if (tcpPort != null) {
      context.put(Services.TCP_PORT,tcpPort);
    }
 else {
      context.put(Services.TCP_PORT,servletContext.getInitParameter(Services.TCP_PORT));
    }
    if (serverIp != null) {
      context.put(Services.SERVER_IP,serverIp);
    }
 else {
      context.put(Services.SERVER_IP,servletContext.getInitParameter(Services.SERVER_IP));
    }
    if (udpPort != null) {
      context.put(Services.UDP_PORT,udpPort);
    }
 else {
      context.put(Services.UDP_PORT,servletContext.getInitParameter(Services.UDP_PORT));
    }
    if (superuserUsername != null) {
      context.put(Services.SUPERUSER_USERNAME,superuserUsername);
    }
 else {
      context.put(Services.SUPERUSER_USERNAME,servletContext.getInitParameter(Services.SUPERUSER_USERNAME));
    }
    if (superuserPassword != null) {
      context.put(Services.SUPERUSER_PASSWORD,superuserPassword);
    }
 else {
      context.put(Services.SUPERUSER_PASSWORD,servletContext.getInitParameter(Services.SUPERUSER_PASSWORD));
    }
  }
 catch (  Throwable t) {
    logger.log(Level.WARNING,"Could not inititialize all values");
  }
  context.put(Services.STRUCTR_PAGE_PREDICATE,new Predicate<Class>(){
    @Override public boolean evaluate(    Class obj){
      return (StructrPage.class.isAssignableFrom(obj));
    }
  }
);
  Services.initialize(context);
  Services.command(StartCloudService.class);
  logger.log(Level.INFO,"structr application context initialized (structr started successfully)");
}
