{
  JsonObject object=new JsonObject();
  for (  Entry<String,Object> entry : map.entrySet()) {
    String key=entry.getKey();
    Object value=entry.getValue();
    if (key != null) {
      if (key.equals(idProperty)) {
        key="id";
      }
      if (value != null) {
        if (value instanceof GraphObject) {
          if (nested) {
            object.add(key,serializeNestedKeyValueType((GraphObject)value,typeOfT,context,includeType,localPropertyView,depth + 1));
          }
 else {
            object.add(key,serializeFlatNameValue((GraphObject)value,typeOfT,context,localPropertyView,depth + 1));
          }
        }
 else         if (value instanceof Map) {
          object.add(key,serializeMap((Map)value,typeOfT,context,localPropertyView,false,false,depth + 1));
        }
 else         if (value instanceof Iterable) {
          object.add(key,serializeIterable((Iterable)value,typeOfT,context,localPropertyView,depth));
        }
 else {
          object.add(key,primitive(value));
        }
      }
 else {
        object.add(key,new JsonNull());
      }
    }
  }
  return object;
}
