{
  logger.log(Level.INFO,"Shutting down service layer");
  for (Iterator<Service> it=serviceCache.values().iterator(); it.hasNext(); ) {
    Service service=it.next();
    try {
      if (service instanceof RunnableService) {
        RunnableService runnableService=(RunnableService)service;
        runnableService.stopService();
      }
      service.shutdown();
    }
 catch (    Throwable t) {
      logger.log(Level.WARNING,"Failed to shut down {0}: {1}",new Object[]{service.getName(),t.getMessage()});
    }
  }
  serviceCache.clear();
  logger.log(Level.INFO,"Finished shutdown of service layer");
}
