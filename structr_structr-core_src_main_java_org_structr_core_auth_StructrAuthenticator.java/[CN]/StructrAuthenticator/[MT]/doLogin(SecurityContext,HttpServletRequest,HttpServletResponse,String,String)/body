{
  String errorMsg=null;
  User user=AuthHelper.getUserForUsernameAndPassword(securityContext,userName,password);
  if (errorMsg != null) {
    throw new AuthenticationException(errorMsg);
  }
  try {
    HttpSession session=request.getSession();
    session.setAttribute(USER_NODE_KEY,user);
    session.setAttribute(USERNAME_KEY,userName);
  }
 catch (  Exception e) {
    logger.log(Level.INFO,"Could not register session");
  }
  return user;
}
