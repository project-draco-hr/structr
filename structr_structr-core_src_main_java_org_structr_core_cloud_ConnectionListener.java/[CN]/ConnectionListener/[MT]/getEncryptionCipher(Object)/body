{
  if (encryptionCipher == null) {
    if (targetUser != null) {
      logger.log(Level.FINE,"Creating encryption cipher for {0}: user {1}",new Object[]{obj,targetUser.getName()});
      String password=targetUser.getEncryptedPassword();
      if (password != null) {
        try {
          byte[] key=DigestUtils.md5(password);
          SecretKeySpec keySpec=new SecretKeySpec(key,"Blowfish");
          encryptionCipher=Cipher.getInstance("Blowfish");
          encryptionCipher.init(Cipher.ENCRYPT_MODE,keySpec);
        }
 catch (        Throwable t) {
          logger.log(Level.WARNING,"Unable to initialize encryption cipher: {0}",t);
        }
      }
 else {
        logger.log(Level.WARNING,"Unable to initialize encryption cipher, password was null!");
      }
    }
 else {
      logger.log(Level.WARNING,"NOT creating encryption cipher for {0}, no user set",obj);
    }
  }
  return (encryptionCipher);
}
