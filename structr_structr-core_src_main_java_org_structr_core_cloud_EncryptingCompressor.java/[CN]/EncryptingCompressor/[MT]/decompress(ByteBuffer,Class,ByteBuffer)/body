{
  int remoteEntityId=Kryo.getContext().getRemoteEntityID();
  Cipher cipher=EncryptionContext.getDecryptionCipher(remoteEntityId);
  if (cipher != null) {
    try {
      cipher.doFinal(inputBuffer,outputBuffer);
    }
 catch (    Throwable t) {
      EncryptionContext.setErrorMessage(remoteEntityId,t.getMessage());
      t.printStackTrace();
    }
  }
 else {
    logger.log(Level.INFO,"sending {0} bytes without encryption",(inputBuffer.limit() - inputBuffer.position()));
    outputBuffer.put(inputBuffer);
  }
}
