{
  FileNodeDataContainer container=new FileNodeDataContainer(file);
  client.sendTCP(container);
  progressNotification.increaseProgress();
  for (  FileNodeChunk chunk : FileNodeDataContainer.getChunks(file,chunkSize)) {
    try {
      client.sendTCP(chunk);
      listener.waitFor(chunk.getSequenceNumber());
    }
 catch (    Throwable t) {
      break;
    }
    progressNotification.increaseProgress();
  }
  client.sendTCP(new FileNodeEndChunk(container.getSourceNodeId(),container.getFileSize()));
  progressNotification.increaseProgress();
}
