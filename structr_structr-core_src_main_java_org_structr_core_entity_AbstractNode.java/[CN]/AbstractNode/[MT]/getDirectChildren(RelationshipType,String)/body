{
  List<AbstractNode> nodes=new LinkedList<AbstractNode>();
  Command nodeFactory=null;
  if (relType.equals(RelType.LINK)) {
    nodeFactory=Services.command(LinkNodeFactoryCommand.class);
  }
 else {
    nodeFactory=Services.command(NodeFactoryCommand.class);
  }
  Command relsCommand=Services.command(NodeRelationshipsCommand.class);
  List<StructrRelationship> rels=(List<StructrRelationship>)relsCommand.execute(this,relType,Direction.OUTGOING);
  for (  StructrRelationship r : rels) {
    AbstractNode s=(AbstractNode)nodeFactory.execute(r.getEndNode());
    if (s.readAllowed() && (nodeType == null || nodeType.equals(s.getType()))) {
      nodes.add(s);
    }
  }
  return nodes;
}
