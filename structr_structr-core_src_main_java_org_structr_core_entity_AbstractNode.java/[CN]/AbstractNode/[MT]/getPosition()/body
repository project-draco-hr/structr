{
  Object p=getProperty(Key.position.name());
  Long pos;
  if (p != null) {
    if (p instanceof Long) {
      return (Long)p;
    }
 else     if (p instanceof Integer) {
      try {
        pos=Long.parseLong(p.toString());
        try {
          setPosition(pos);
        }
 catch (        FrameworkException fex) {
          logger.log(Level.WARNING,"Unable to set position property",fex);
        }
      }
 catch (      NumberFormatException e) {
        pos=getId();
        return pos;
      }
    }
 else     if (p instanceof String) {
      try {
        pos=Long.parseLong(((String)p));
        try {
          setPosition(pos);
        }
 catch (        FrameworkException fex) {
          logger.log(Level.WARNING,"Unable to set position property",fex);
        }
      }
 catch (      NumberFormatException e) {
        pos=getId();
        return pos;
      }
    }
 else {
      logger.log(Level.SEVERE,"Position property not stored as Integer or String: {0}",p.getClass().getName());
    }
  }
  long id=getId();
  logger.log(Level.FINE,"No position property in database, writing id {0} to database",id);
  try {
    setPosition(id);
  }
 catch (  FrameworkException fex) {
    logger.log(Level.WARNING,"Unable to set position property",fex);
  }
  return id;
}
