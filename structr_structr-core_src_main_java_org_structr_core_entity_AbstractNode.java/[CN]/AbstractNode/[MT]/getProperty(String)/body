{
  Object value=null;
  Class type=this.getClass();
  PropertyGroup propertyGroup=EntityContext.getPropertyGroup(type,key);
  if (propertyGroup != null) {
    return propertyGroup.getGroupedProperties(this);
  }
  if (EntityContext.getRelations(type).containsKey(key)) {
    DirectedRelationship rel=EntityContext.getRelations(type).get(key);
    Notion notion=rel.getNotion();
switch (rel.getCardinality()) {
case ManyToMany:
case OneToMany:
      return new IterableAdapter(rel.getRelatedNodes(securityContext,this),notion.getAdapterForGetter(securityContext));
case OneToOne:
case ManyToOne:
    return notion.getAdapterForGetter(securityContext).adapt(rel.getRelatedNode(securityContext,this));
}
}
if (isDirty) {
value=properties.get(key);
}
if (key.equals(Key.visibleToPublicUsers.name()) && dbNode.hasProperty("public")) {
final Object oldValue=dbNode.getProperty("public");
StructrTransaction transaction=new StructrTransaction(){
  @Override public Object execute() throws Throwable {
    dbNode.setProperty(Key.visibleToPublicUsers.name(),oldValue);
    dbNode.removeProperty("public");
    return null;
  }
}
;
Services.command(securityContext,TransactionCommand.class).execute(transaction);
if (transaction.getCause() != null) {
  logger.log(Level.WARNING,"Error while setting property",transaction.getCause());
}
}
if ((key != null) && (dbNode != null) && dbNode.hasProperty(key)) {
value=dbNode.getProperty(key);
}
PropertyConverter converter=EntityContext.getPropertyConverter(securityContext,type,key);
if (converter != null) {
Value conversionValue=EntityContext.getPropertyConversionParameter(type,key);
converter.setCurrentNode(this);
value=converter.convertForGetter(value,conversionValue);
}
return value;
}
