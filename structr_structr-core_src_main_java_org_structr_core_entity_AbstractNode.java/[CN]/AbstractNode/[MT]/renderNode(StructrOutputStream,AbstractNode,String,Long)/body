{
  if (this.equals(startNode) && !(this.renderingAllowed(RenderContext.AsTopNode))) {
    return;
  }
  if (!(this.equals(startNode)) && !(this.renderingAllowed(RenderContext.AsSubnode))) {
    return;
  }
  if (!renderersInitialized) {
    initializeRenderers(rendererMap);
    renderersInitialized=true;
  }
  RenderMode renderMode=RenderMode.Default;
  if (this.equals(startNode) && rendererMap.containsKey(RenderMode.Direct)) {
    renderMode=RenderMode.Direct;
  }
  if ((editNodeId != null) && (getId() == editNodeId.longValue())) {
    renderMode=RenderMode.Edit;
  }
  NodeRenderer nodeRenderer=rendererMap.get(renderMode);
  if (nodeRenderer == null) {
    logger.log(Level.FINE,"No renderer found for mode {0}, using default renderers",renderMode);
switch (renderMode) {
case Default:
      nodeRenderer=new DefaultRenderer();
    break;
case Direct:
  break;
case Edit:
nodeRenderer=new DefaultEditRenderer();
break;
}
}
logger.log(Level.FINE,"Got renderer {0} for mode {1}, node type {2} ({3})",new Object[]{(nodeRenderer != null) ? nodeRenderer.getClass().getName() : "Unknown",renderMode,this.getType(),this.getId()});
if (nodeRenderer != null) {
out.setContentType(nodeRenderer.getContentType(this));
nodeRenderer.renderNode(out,this,startNode,editUrl,editNodeId,renderMode);
}
 else {
logger.log(Level.WARNING,"No renderer for mode {0}, node {1}",new Object[]{renderMode,this.getId()});
}
}
