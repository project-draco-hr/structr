{
  final String type=this.getClass().getSimpleName();
  final String key=getStartNodeIdKey().name();
  if (startNodeId == null) {
    throw new FrameworkException(type,new NullPropertyToken(key));
  }
  Command transaction=Services.command(securityContext,TransactionCommand.class);
  transaction.execute(new StructrTransaction(){
    @Override public Object execute() throws FrameworkException {
      Command deleteRel=Services.command(securityContext,DeleteRelationshipCommand.class);
      Command createRel=Services.command(securityContext,CreateRelationshipCommand.class);
      Command nodeFactory=Services.command(securityContext,NodeFactoryCommand.class);
      AbstractNode newStartNode=getNodeByUuid(startNodeId);
      AbstractNode endNode=(AbstractNode)nodeFactory.execute(getEndNode());
      if (newStartNode == null) {
        throw new FrameworkException(type,new IdNotFoundToken(startNodeId));
      }
      RelationshipType type=dbRelationship.getType();
      properties=getProperties();
      deleteRel.execute(dbRelationship);
      AbstractRelationship newRel=(AbstractRelationship)createRel.execute(newStartNode,endNode,type);
      newRel.setProperties(properties);
      dbRelationship=newRel.getRelationship();
      return (null);
    }
  }
);
}
