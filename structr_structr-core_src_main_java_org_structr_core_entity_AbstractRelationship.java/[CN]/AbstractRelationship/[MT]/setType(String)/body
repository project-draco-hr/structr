{
  if (type != null) {
    try {
      Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
        @Override public Object execute() throws FrameworkException {
          DeleteRelationshipCommand deleteRel=Services.command(securityContext,DeleteRelationshipCommand.class);
          CreateRelationshipCommand createRel=Services.command(securityContext,CreateRelationshipCommand.class);
          AbstractNode startNode=getStartNode();
          AbstractNode endNode=getEndNode();
          deleteRel.execute(dbRelationship);
          dbRelationship=createRel.execute(startNode,endNode,type).getRelationship();
          return (null);
        }
      }
);
    }
 catch (    FrameworkException fex) {
      logger.log(Level.WARNING,"Unable to set relationship type",fex);
    }
  }
}
