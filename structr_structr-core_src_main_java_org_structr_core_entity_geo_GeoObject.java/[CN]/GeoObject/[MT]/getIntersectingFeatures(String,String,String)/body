{
  Envelope localEnv=null;
  if (layerName.equals(layer.getName())) {
    localEnv=env;
  }
 else {
    localEnv=getEnvelope(layerName,propertyKey,featureName);
  }
  if (localEnv != null) {
    Search searchQuery=new SearchIntersectWindow(localEnv);
    spatialIndex.executeSearch(searchQuery);
    List<SpatialDatabaseRecord> results=searchQuery.getResults();
    List<String> result=new LinkedList<String>();
    for (    SpatialDatabaseRecord r : results) {
      String value=(String)r.getProperty(propertyKey);
      result.add(value);
    }
    return (String[])result.toArray(new String[result.size()]);
  }
 else {
    logger.log(Level.SEVERE,"No envelope found");
  }
  return null;
}
