{
  logger.log(Level.INFO,"Starting LogService");
  getGlobalLog();
  while (run || !queue.isEmpty()) {
    logger.log(Level.FINER,"Checking queue..");
    if (!queue.isEmpty() && ((queue.size() > threshold) || !run)) {
      while (!queue.isEmpty()) {
        Object o=queue.poll();
        if (o != null && o instanceof Activity) {
          Activity activity=(Activity)o;
          User user=activity.getUser();
          activity.commit(new SuperUser());
          LogNodeList globalLog=getGlobalLog();
          globalLog.add(activity);
          LogNodeList userLog=getUserLog(user);
          userLog.add(activity);
        }
        Thread.yield();
      }
    }
    try {
      Thread.sleep(interval);
    }
 catch (    Throwable t) {
    }
  }
}
