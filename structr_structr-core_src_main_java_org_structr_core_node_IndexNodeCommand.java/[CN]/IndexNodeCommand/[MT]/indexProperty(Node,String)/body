{
  if (key == null) {
    logger.log(Level.SEVERE,"Node {0} has null key",new Object[]{node.getId()});
    return;
  }
  boolean emptyKey=StringUtils.isEmpty((String)key);
  if (emptyKey) {
    logger.log(Level.SEVERE,"Node {0} has empty, not-null key, removing property",new Object[]{node.getId()});
    node.removeProperty(key);
    return;
  }
  Object value=node.getProperty(key);
  boolean emptyValue=(value instanceof String && StringUtils.isEmpty((String)value));
  if (value == null) {
    logger.log(Level.SEVERE,"Node {0} has null value for key {1}, removing property",new Object[]{node.getId(),key});
    node.removeProperty(key);
  }
 else   if (emptyValue) {
    logger.log(Level.WARNING,"Node {0} has empty, non-null value for key {1}",new Object[]{node.getId(),key});
  }
 else {
    index.remove(node,key,value);
    logger.log(Level.FINE,"Node {0}: Key {1}, Value {2} removed from index",new Object[]{node.getId(),key,value});
    index.add(node,key,value);
    logger.log(Level.FINE,"Node {0}: Key {1}, Value {2} added to index",new Object[]{node.getId(),key,value});
  }
}
