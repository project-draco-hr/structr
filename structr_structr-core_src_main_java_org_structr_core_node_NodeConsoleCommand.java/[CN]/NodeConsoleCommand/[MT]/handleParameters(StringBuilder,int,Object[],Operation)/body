{
  int parameterCount=operation.getParameterCount();
  int ret=0;
  for (int j=0; j < parameterCount; j++) {
    ret+=1;
    int parameterPosition=currentPosition + ret;
    if (parameterPosition < commands.length) {
      Object parameter=commands[parameterPosition];
      if (parameter.toString().startsWith("-")) {
        operation.addSwitch(parameter.toString());
        parameterCount++;
      }
 else {
        operation.addParameter(parameter);
      }
    }
  }
  if (!operation.canExecute()) {
    throw new InvalidParameterException(operation.getKeyword() + " needs " + operation.getParameterCount()+ " parameters");
  }
  return (ret);
}
