{
  final GraphDatabaseService graphDb=(GraphDatabaseService)arguments.get("graphDb");
  final StructrNodeFactory nodeFactory=(StructrNodeFactory)arguments.get("nodeFactory");
  Command transactionCommand=Services.createCommand(TransactionCommand.class);
  return (transactionCommand.execute(new StructrTransaction(){
    @Override public Object execute() throws Throwable {
      if (graphDb != null) {
        Node listNode=graphDb.getNodeById(6);
        if (listNode != null) {
          NodeList nodeList=(NodeList)nodeFactory.createNode(listNode);
          if (nodeList != null) {
            if (parameters.length > 0) {
              String cmd=parameters[0].toString();
              if ("add".equals(cmd)) {
                Node newNode=graphDb.createNode();
                newNode.setProperty("type","PlainText");
                StructrNode newStructrNode=nodeFactory.createNode(newNode);
                nodeList.add(newStructrNode);
              }
 else               if ("del".equals(cmd)) {
                nodeList.remove(nodeList.size() - 1);
              }
            }
            return (nodeList);
          }
 else {
            logger.log(Level.INFO,"nodeList was null!");
          }
        }
 else {
          logger.log(Level.INFO,"listNode was null!");
        }
      }
 else {
        logger.log(Level.INFO,"graphDb was null!");
      }
      return null;
    }
  }
));
}
