{
  boolean ret=false;
  if (relationships.isEmpty()) {
    relationships.add("LINK");
  }
  if (parameterState.equals(ParameterState.EndNodeSet)) {
    Command createRelationshipCommand=Services.command(securityContext,CreateRelationshipCommand.class);
    for (    String rel : relationships) {
      try {
        final StructrRelationship newRel=(StructrRelationship)createRelationshipCommand.execute(startNode,endNode,rel);
        if (newRel != null) {
          Services.command(securityContext,TransactionCommand.class).execute(new StructrTransaction(){
            @Override public Object execute() throws FrameworkException {
              for (              NodeAttribute attribute : attributes) {
                newRel.setProperty(attribute.getKey(),attribute.getValue());
              }
              return (null);
            }
          }
);
          ret=true;
        }
 else {
          ret=false;
        }
      }
 catch (      FrameworkException fex) {
        fex.printStackTrace();
      }
    }
  }
 else {
    throw new NodeCommandException("Invalid number of parameters");
  }
  return (ret);
}
