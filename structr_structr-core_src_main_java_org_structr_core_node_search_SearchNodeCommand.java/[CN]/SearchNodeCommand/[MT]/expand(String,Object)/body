{
  if (StringUtils.isBlank(key)) {
    return "";
  }
  String stringValue=null;
  String escapedKey=Search.escapeForLucene(key);
  if (value instanceof String) {
    stringValue=(String)value;
    if (StringUtils.isBlank(stringValue)) {
      return "";
    }
  }
  if ((stringValue.length() > 1) && (stringValue.startsWith("\"") && stringValue.endsWith("\"")) || (stringValue.startsWith("[") && stringValue.endsWith("]")) || stringValue.startsWith("NOT") || stringValue.startsWith("AND") || stringValue.startsWith("OR")) {
    return " " + escapedKey + ":"+ stringValue+ " ";
  }
  String result="( ";
  stringValue=Search.escapeForLucene(stringValue);
  String[] words=StringUtils.split(stringValue," ");
  int i=1;
  for (  String word : words) {
    result+=" (" + escapedKey + ":*"+ word+ "* OR "+ escapedKey+ ":\""+ word+ "\")"+ ((i < words.length) ? " AND " : " ) ");
    i++;
  }
  return result;
}
