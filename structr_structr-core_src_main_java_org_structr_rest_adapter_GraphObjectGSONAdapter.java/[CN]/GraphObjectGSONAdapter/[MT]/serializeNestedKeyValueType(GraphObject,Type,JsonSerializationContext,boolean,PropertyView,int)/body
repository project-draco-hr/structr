{
  if (depth > outputNestingDepth) {
    return null;
  }
  JsonObject jsonObject=new JsonObject();
  jsonObject.add("id",new JsonPrimitive(src.getId()));
  String type=src.getType();
  if (type != null) {
    jsonObject.add("type",new JsonPrimitive(type));
  }
  JsonArray properties=new JsonArray();
  for (  String key : src.getPropertyKeys(localPropertyView)) {
    Object value=src.getProperty(key);
    if (value instanceof Collection) {
      Collection<GraphObject> values=(Collection<GraphObject>)value;
      JsonArray property=new JsonArray();
      for (      GraphObject obj : values) {
        JsonElement recursiveSerializedValue=this.serializeNestedKeyValueType(obj,typeOfSrc,context,includeTypeInOutput,localPropertyView,depth + 1);
        if (recursiveSerializedValue != null) {
          property.add(recursiveSerializedValue);
        }
      }
      properties.add(property);
    }
 else {
      JsonObject property=new JsonObject();
      property.add("key",new JsonPrimitive(key));
      if (value != null) {
        property.add("value",new JsonPrimitive(value.toString()));
        if (includeTypeInOutput) {
          String valueType=value.getClass().getSimpleName();
          property.add("type",new JsonPrimitive(valueType));
        }
      }
 else {
        property.add("value",new JsonNull());
        if (includeTypeInOutput) {
          property.add("type",new JsonNull());
        }
      }
      properties.add(property);
    }
  }
  jsonObject.add("properties",properties);
  Map<RelationshipType,Long> outRelStatistics=src.getRelationshipInfo(Direction.OUTGOING);
  if (outRelStatistics != null) {
    JsonArray outRels=new JsonArray();
    for (    Entry<RelationshipType,Long> entry : outRelStatistics.entrySet()) {
      RelationshipType relType=entry.getKey();
      Long count=entry.getValue();
      JsonObject outRelEntry=new JsonObject();
      outRelEntry.add("type",new JsonPrimitive(relType.name()));
      outRelEntry.add("count",new JsonPrimitive(count));
      outRels.add(outRelEntry);
    }
    jsonObject.add("out",outRels);
  }
  Map<RelationshipType,Long> inRelStatistics=src.getRelationshipInfo(Direction.INCOMING);
  if (inRelStatistics != null) {
    JsonArray inRels=new JsonArray();
    for (    Entry<RelationshipType,Long> entry : inRelStatistics.entrySet()) {
      RelationshipType relType=entry.getKey();
      Long count=entry.getValue();
      JsonObject inRelEntry=new JsonObject();
      inRelEntry.add("type",new JsonPrimitive(relType.name()));
      inRelEntry.add("count",new JsonPrimitive(count));
      inRels.add(inRelEntry);
    }
    jsonObject.add("in",inRels);
  }
  Long startNodeId=src.getStartNodeId();
  if (startNodeId != null) {
    jsonObject.add("startNodeId",new JsonPrimitive(startNodeId));
  }
  Long endNodeId=src.getEndNodeId();
  if (endNodeId != null) {
    jsonObject.add("endNodeId",new JsonPrimitive(endNodeId));
  }
  return jsonObject;
}
