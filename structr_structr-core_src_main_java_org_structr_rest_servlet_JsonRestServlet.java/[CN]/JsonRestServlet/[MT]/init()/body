{
  PropertyFormat propertyFormat=initializePropertyFormat();
  this.graphObjectListeners=new LinkedList<VetoableGraphObjectListener>();
  this.constraintMap=new LinkedHashMap<Pattern,Class>();
  this.propertyView=new ThreadLocalPropertyView();
  this.resultGsonAdapter=new ResultGSONAdapter(propertyFormat,propertyView);
  this.propertySetAdapter=new PropertySetGSONAdapter(propertyFormat);
  this.gson=new GsonBuilder().setPrettyPrinting().serializeNulls().registerTypeAdapter(PropertySet.class,propertySetAdapter).registerTypeAdapter(Result.class,resultGsonAdapter).create();
  String externalProviderName=this.getInitParameter(SERVLET_PARAMETER_CONSTRAINT_PROVIDER);
  if (externalProviderName != null) {
    String[] parts=externalProviderName.split("[, ]+");
    for (    String part : parts) {
      try {
        logger.log(Level.INFO,"Injecting constraints from provider {0}",part);
        Class providerClass=Class.forName(part);
        ResourceConstraintProvider provider=(ResourceConstraintProvider)providerClass.newInstance();
        constraintMap.putAll(provider.getConstraints());
      }
 catch (      Throwable t) {
        logger.log(Level.WARNING,"Unable to inject external resource constraints",t);
      }
    }
  }
  String externalListenerName=this.getInitParameter(SERVLET_PARAMETER_MODIFICATION_LISTENER);
  if (externalListenerName != null) {
    String[] parts=externalListenerName.split("[, ]+");
    for (    String part : parts) {
      try {
        logger.log(Level.INFO,"Injecting listener {0}",part);
        Class listenerClass=Class.forName(part);
        VetoableGraphObjectListener listener=(VetoableGraphObjectListener)listenerClass.newInstance();
        graphObjectListeners.add(listener);
      }
 catch (      Throwable t) {
        logger.log(Level.WARNING,"Unable to instantiate listener",t);
      }
    }
  }
  String defaultPropertyViewName=this.getInitParameter(SERVLET_PARAMETER_DEFAULT_PROPERTY_VIEW);
  if (defaultPropertyViewName != null) {
    logger.log(Level.INFO,"Setting default property view to {0}",defaultPropertyViewName);
    this.defaultPropertyView=defaultPropertyViewName;
  }
}
