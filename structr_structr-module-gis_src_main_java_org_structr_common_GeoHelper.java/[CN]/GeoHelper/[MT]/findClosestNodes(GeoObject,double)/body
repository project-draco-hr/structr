{
  SecurityContext securityContext=SecurityContext.getSuperUserInstance();
  Set<AbstractNode> result=new HashSet<AbstractNode>();
  GraphDatabaseService graphDb=(GraphDatabaseService)Services.command(securityContext,GraphDatabaseCommand.class).execute();
  final SpatialDatabaseService db=new SpatialDatabaseService(graphDb);
  SimplePointLayer layer=(SimplePointLayer)db.getLayer("Hotels");
  Command findNode=Services.command(securityContext,FindNodeCommand.class);
  Coordinate myPosition=node.getCoordinates();
  List<SpatialDatabaseRecord> results=layer.findClosestPointsTo(myPosition,radius);
  for (  SpatialDatabaseRecord record : results) {
    Long nodeId=(Long)record.getProperty("nodeId");
    if (nodeId.equals(node.getId())) {
      continue;
    }
    AbstractNode newNode=(AbstractNode)findNode.execute(new SuperUser(),nodeId);
    result.add(newNode);
  }
  return result;
}
