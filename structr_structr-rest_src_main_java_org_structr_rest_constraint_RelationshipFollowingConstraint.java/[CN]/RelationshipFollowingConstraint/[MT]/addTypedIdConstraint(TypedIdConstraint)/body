{
  logger.log(Level.FINE,"Adding id {0} to id set",typedIdConstraint.getIdConstraint().getUriPart());
  IdConstraint idConstraint=typedIdConstraint.getIdConstraint();
  if (idConstraint instanceof UuidConstraint) {
    if (!idSet.add(((UuidConstraint)idConstraint).getUriPart())) {
      throw new IllegalPathException();
    }
  }
 else {
    if (!idSet.add(idConstraint.getId())) {
      throw new IllegalPathException();
    }
  }
  uriParts.add(typedIdConstraint.getUriPart());
  DirectedRelationship rel=findDirectedRelationship(lastConstraint,typedIdConstraint);
  if (rel != null) {
    if (!visitedRelationships.contains(rel)) {
      traversalDescription=traversalDescription.relationships(rel.getRelType(),rel.getDirection());
      visitedRelationships.add(rel);
    }
  }
 else {
    String rawType1=lastConstraint.getTypeConstraint().getRawType();
    String rawType2=typedIdConstraint.getTypeConstraint().getRawType();
    logger.log(Level.INFO,"No relationship defined between {0} and {1}, illegal path",new Object[]{rawType1,rawType2});
    throw new IllegalPathException();
  }
  lastConstraint=typedIdConstraint;
}
