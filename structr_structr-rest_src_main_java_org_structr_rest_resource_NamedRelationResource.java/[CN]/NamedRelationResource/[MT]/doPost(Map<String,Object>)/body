{
  final AbstractRelationship relationshipEntity=namedRelation.newEntityClass();
  if (relationshipEntity != null) {
    relationshipEntity.init(securityContext);
    final Command createRel=Services.command(securityContext,CreateRelationshipCommand.class);
    final AbstractNode startNode=relationshipEntity.identifyStartNode(namedRelation,propertySet);
    final AbstractNode endNode=relationshipEntity.identifyEndNode(namedRelation,propertySet);
    final RelationshipType relType=namedRelation.getRelType();
    final ErrorBuffer errorBuffer=new ErrorBuffer();
    boolean hasError=false;
    if (startNode == null) {
      errorBuffer.add(namedRelation.getName(),new EmptyPropertyToken(relationshipEntity.getStartNodeIdKey().name()));
      hasError=true;
    }
    if (endNode == null) {
      errorBuffer.add(namedRelation.getName(),new EmptyPropertyToken(relationshipEntity.getEndNodeIdKey().name()));
      hasError=true;
    }
    if (hasError) {
      throw new FrameworkException(422,errorBuffer);
    }
    final Class sourceType=namedRelation.getSourceType();
    final Class destType=namedRelation.getDestType();
    propertySet.put(AbstractRelationship.HiddenKey.combinedType.name(),EntityContext.createCombinedRelationshipType(sourceType,relType,destType));
    final AbstractRelationship newRel=(AbstractRelationship)createRel.execute(startNode,endNode,relType,propertySet,false);
    final RestMethodResult result=new RestMethodResult(201);
    result.addHeader("Location",buildLocationHeader(newRel));
    return result;
  }
  throw new FrameworkException(422,"FIXME");
}
