{
  List<GraphObject> list=result.getResults();
  boolean headerWritten=false;
  for (  GraphObject obj : list) {
    if (!headerWritten) {
      StringBuilder row=new StringBuilder();
      for (      PropertyKey key : obj.getPropertyKeys(defaultPropertyView)) {
        row.append("\"").append(key.dbName()).append("\",");
      }
      row.deleteCharAt(row.lastIndexOf(","));
      out.append(row).append("\n");
      out.flush();
      headerWritten=true;
    }
    StringBuilder row=new StringBuilder();
    for (    PropertyKey key : obj.getPropertyKeys(defaultPropertyView)) {
      Object value=obj.getProperty(key);
      row.append("\"").append((value != null ? StringUtils.replace(value.toString(),"\"","\\\"") : "")).append("\",");
    }
    row.deleteCharAt(row.lastIndexOf(","));
    out.append(row).append("\n");
    out.flush();
  }
}
