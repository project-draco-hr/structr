{
  String userName=request.getHeader("X-User");
  String password=request.getHeader("X-Password");
  String token=request.getHeader("X-StructrSessionToken");
  User user=null;
  if (token != null) {
    user=AuthHelper.getUserForToken(token);
  }
 else   if ((userName != null) && (password != null)) {
    user=AuthHelper.getUserForUsernameAndPassword(securityContext,userName,password);
  }
  if (user != null) {
    securityContext.setUser(user);
  }
  return user;
}
