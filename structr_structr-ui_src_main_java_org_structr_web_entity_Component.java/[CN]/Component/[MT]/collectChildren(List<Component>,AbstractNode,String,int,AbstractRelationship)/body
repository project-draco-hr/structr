{
  if (depth > MAX_DEPTH) {
    return;
  }
  if (ref != null) {
    if (startNode instanceof Component) {
      children.add((Component)startNode);
      return;
    }
  }
  for (  AbstractRelationship rel : getChildRelationships(null,startNode,null,componentId)) {
    AbstractNode endNode=rel.getEndNode();
    if (endNode == null) {
      continue;
    }
    collectChildren(children,endNode,componentId,depth + 1,rel);
  }
}
