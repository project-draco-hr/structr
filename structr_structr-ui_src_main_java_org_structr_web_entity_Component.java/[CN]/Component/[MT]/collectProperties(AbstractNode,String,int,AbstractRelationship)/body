{
  if (depth > MAX_DEPTH) {
    return;
  }
  if (ref != null) {
    if (componentId.equals(ref.getStringProperty(Component.componentId))) {
      String dataKey=startNode.getStringProperty(Content.dataKey);
      if (dataKey != null) {
        contentNodes.put(dataKey,startNode);
        return;
      }
    }
  }
  for (  AbstractRelationship rel : getChildRelationships(null,startNode,null,componentId)) {
    AbstractNode endNode=rel.getEndNode();
    if (endNode == null) {
      continue;
    }
    if (endNode instanceof Component) {
      String subType=endNode.getStringProperty(Component.kind);
      if (subType != null) {
        subTypes.add(subType);
      }
    }
 else {
      collectProperties(endNode,componentId,depth + 1,rel);
    }
  }
}
