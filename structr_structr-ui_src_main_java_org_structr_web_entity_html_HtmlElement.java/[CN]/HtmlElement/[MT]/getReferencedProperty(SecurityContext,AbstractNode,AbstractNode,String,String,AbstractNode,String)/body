{
  AbstractNode node=startNode;
  String[] parts=refKey.split("[\\.]+");
  String referenceKey=parts[parts.length - 1];
  for (int i=0; (i < parts.length) && (node != null); i++) {
    String part=parts[i];
    if ("request".equals(part.toLowerCase())) {
      HttpServletRequest request=securityContext.getRequest();
      if (request != null) {
        return request.getParameter(referenceKey);
      }
    }
    if ("component".equals(part.toLowerCase())) {
      node=getNodeById(securityContext,componentId);
      continue;
    }
    if ("resource".equals(part.toLowerCase())) {
      node=getNodeById(securityContext,pageId);
      continue;
    }
    if ("page".equals(part.toLowerCase())) {
      node=page;
      continue;
    }
    if ("link".equals(part.toLowerCase())) {
      for (      AbstractRelationship rel : node.getRelationships(RelType.LINK,Direction.OUTGOING)) {
        node=rel.getEndNode();
        break;
      }
      continue;
    }
    if ("parent".equals(part.toLowerCase())) {
      for (      AbstractRelationship rel : node.getRelationships(RelType.CONTAINS,Direction.INCOMING)) {
        if (rel.getProperty(pageId) != null) {
          node=rel.getStartNode();
          break;
        }
      }
      continue;
    }
    if ("owner".equals(part.toLowerCase())) {
      for (      AbstractRelationship rel : node.getRelationships(RelType.OWNS,Direction.INCOMING)) {
        node=rel.getStartNode();
        break;
      }
      continue;
    }
    if ("data".equals(part.toLowerCase())) {
      node=viewComponent;
      continue;
    }
    if ("root".equals(part.toLowerCase())) {
      List<Page> pages=getPages(securityContext,viewComponent);
      if (pages.isEmpty()) {
        continue;
      }
      node=pages.get(0);
      continue;
    }
  }
  if (node != null) {
    return node.getProperty(referenceKey);
  }
  return null;
}
