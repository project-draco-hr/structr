{
  Command createRel=Services.command(securityContext,CreateRelationshipCommand.class);
  for (  AbstractRelationship in : sourceNode.getIncomingRelationships()) {
    AbstractNode startNode=in.getStartNode();
    RelationshipType relType=in.getRelType();
    AbstractRelationship newInRel=(AbstractRelationship)createRel.execute(startNode,targetNode,relType);
    newInRel.setProperty("type",in.getStringProperty("type"));
    newInRel.setProperty("componentId",componentId);
    String resourceId=in.getStringProperty("resourceId");
    if (resourceId != null) {
      newInRel.setProperty("resourceId",resourceId);
      Integer pos=in.getIntProperty(resourceId);
      newInRel.setProperty(resourceId,position);
    }
  }
  for (  AbstractRelationship out : sourceNode.getOutgoingRelationships()) {
    AbstractNode endNode=out.getEndNode();
    RelationshipType relType=out.getRelType();
    AbstractRelationship newOutRel=(AbstractRelationship)createRel.execute(targetNode,endNode,relType);
    newOutRel.setProperty("type",out.getStringProperty("type"));
    newOutRel.setProperty("componentId",componentId);
    String resourceId=out.getStringProperty("resourceId");
    if (resourceId != null) {
      newOutRel.setProperty("resourceId",resourceId);
      newOutRel.setProperty(resourceId,position);
    }
  }
}
