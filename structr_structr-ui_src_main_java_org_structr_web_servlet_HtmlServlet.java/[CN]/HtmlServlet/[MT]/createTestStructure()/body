{
  Services.command(SecurityContext.getSuperUserInstance(),TransactionCommand.class).execute(new StructrTransaction(){
    @Override public Object execute() throws FrameworkException {
      logger.log(Level.INFO,"Creating test structure..");
      AbstractNode page1=createNode("Resource","page1");
      AbstractNode page2=createNode("Resource","page2");
      logger.log(Level.INFO,"Created page1 with id {0}, page2 with id {1}",new Object[]{page1.getId(),page2.getId()});
      AbstractNode listJs=createNode("Resource","list.js");
      AbstractNode listJsContent=createNode("Content","list",new NodeAttribute("content",readFile("/ge/js/list.js")));
      linkNodes(listJs,listJsContent,listJs.getIdString(),0);
      AbstractNode doc=createNode("Element","doc",new NodeAttribute("tag","html"));
      AbstractNode head=createNode("Element","header",new NodeAttribute("tag","head"));
      AbstractNode script=createNode("Content","script",new NodeAttribute("content","<script src=\"list.js\" language=\"JavaScript\" type=\"text/javascript\"></script>"));
      AbstractNode body=createNode("Element","body",new NodeAttribute("tag","body"),new NodeAttribute("onload","start()"));
      AbstractNode article1=createNode("Element","article1",new NodeAttribute("tag","div"));
      AbstractNode article2=createNode("Element","article2",new NodeAttribute("tag","div"));
      AbstractNode foo=createNode("Content","content1",new NodeAttribute("content","Dies ist Seite 1"),new NodeAttribute("tag","h1"));
      AbstractNode bar=createNode("Content","content2",new NodeAttribute("content","Dies ist Seite 2"),new NodeAttribute("tag","h1"));
      AbstractNode log=createNode("Content","log",new NodeAttribute("tag","div"));
      AbstractNode foo2=createNode("Content","content3");
      String uuid=foo2.getStringProperty("uuid");
      StringBuilder content=new StringBuilder();
      content.append("<input type=\"hidden\" name=\"token\" id=\"token\" />");
      content.append("<script language=\"JavaScript\" type=\"text/javascript\">\n");
      content.append("function load").append(uuid).append("() {\n");
      content.append("loadList(\"").append(uuid).append("\", \"User\", function(parent, element) {\n");
      content.append("parent.innerHTML += (\"<div>\" + element.realName + \"</div>\");\n");
      content.append("});\n");
      content.append("}\n");
      content.append("window.setTimeout(\"load").append(uuid).append("()\", 500);\n");
      content.append("</script>\n");
      foo2.setProperty("content",content.toString());
      foo2.setProperty("tag","div");
      String idOfPage1=page1.getIdString();
      String idOfPage2=page2.getIdString();
      linkNodes(page1,doc,idOfPage1,0);
      linkNodes(doc,head,idOfPage1,0);
      linkNodes(doc,body,idOfPage1,1);
      linkNodes(head,script,idOfPage1,0);
      linkNodes(body,article1,idOfPage1,1);
      linkNodes(article1,foo,idOfPage1,0);
      linkNodes(article1,foo2,idOfPage1,1);
      linkNodes(body,log,idOfPage1,2);
      linkNodes(page2,doc,idOfPage2,0);
      linkNodes(doc,head,idOfPage2,0);
      linkNodes(doc,body,idOfPage2,1);
      linkNodes(head,script,idOfPage2,0);
      linkNodes(body,article2,idOfPage2,1);
      linkNodes(article2,bar,idOfPage2,0);
      linkNodes(body,log,idOfPage2,2);
      return null;
    }
  }
);
}
