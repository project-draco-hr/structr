{
  request.setCharacterEncoding("UTF-8");
  response.setCharacterEncoding("UTF-8");
  Map<String,String[]> parameterMap=request.getParameterMap();
  String path=PathHelper.clean(request.getPathInfo());
  String restPath=StringUtils.substringAfter(path,PathHelper.PATH_SEP);
  String resp=postToRestUrl(request,restPath,convert(parameterMap));
  if (resp != null) {
    request.getSession().setAttribute(REST_RESPONSE,resp);
  }
  String redirect=null;
  try {
    redirect=request.getParameter(REDIRECT);
    if (redirect == null) {
      redirect=(String)request.getSession().getAttribute(LAST_GET_URL);
      request.getSession().removeAttribute(LAST_GET_URL);
    }
    response.sendRedirect(redirect);
  }
 catch (  IOException ex) {
    logger.log(Level.SEVERE,"Could not redirect to " + redirect,ex);
  }
}
