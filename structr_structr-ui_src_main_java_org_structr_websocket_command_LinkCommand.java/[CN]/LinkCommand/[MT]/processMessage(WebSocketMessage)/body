{
  final SecurityContext securityContext=getWebSocket().getSecurityContext();
  String sourceId=webSocketData.getId();
  Map<String,Object> properties=webSocketData.getNodeData();
  String resourceId=(String)properties.get("resourceId");
  final AbstractNode sourceNode=getNode(sourceId);
  final AbstractNode resourceNode=getNode(resourceId);
  if ((sourceNode != null) && (resourceNode != null)) {
    try {
      Command transactionCommand=Services.command(securityContext,TransactionCommand.class);
      StructrTransaction transaction=new StructrTransaction(){
        @Override public Object execute() throws FrameworkException {
          RelationClass rel=new RelationClass(resourceNode.getClass(),RelType.LINK,Direction.OUTGOING,Cardinality.ManyToOne,null,RelationClass.DELETE_NONE);
          rel.createRelationship(securityContext,sourceNode,resourceNode);
          return null;
        }
      }
;
      transactionCommand.execute(transaction);
    }
 catch (    Throwable t) {
      getWebSocket().send(MessageBuilder.status().code(400).message(t.getMessage()).build(),true);
    }
  }
 else {
    getWebSocket().send(MessageBuilder.status().code(400).message("The LINK command needs id and data.id!").build(),true);
  }
}
